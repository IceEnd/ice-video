!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define("ice-video",["react"],t):"object"==typeof exports?exports["ice-video"]=t(require("react")):e["ice-video"]=t(e.React)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(t,n){t.exports=e},function(e,t,n){"use strict";e.exports=n(2)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(15);var l=n(0),u=r(l),c=n(4),d=r(c),p=n(6),f=r(p),m=n(5),h=r(m),y=n(8),v=r(y),g=n(3),b=r(g),w=n(14),T=r(w),E=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.getStyle=function(){var e={};if(r.props.width&&r.props.height)e.width=r.props.width,e.paddingTop=r.props.height;else switch(e.width="100%",r.props.scale){case"1:1":e.paddingTop="100%";break;case"4:3":e.paddingTop="75%";break;case"16:9":default:e.paddingTop="56.25%"}return e},r.getCurrentTime=function(e){r.setState({video:s(r.state.video,{currentTime:e})})},r.setCurrentTime=function(e){r.setState({playerAction:3,video:s(r.state.video,{currentTime:e})}),r.video.setCurrentTime(e),r.setState({playerAction:1})},r.setVolume=function(e){r.setState({video:s(r.state.video,{volume:e})}),r.video.setVolume(e)},r.setMuted=function(e){r.setState({video:s(r.state.video,{muted:e})}),r.video.setMuted(e)},r.setLoop=function(e){r.setState({video:s(r.state.video,{loop:e})}),r.video.setLoop(e)},r.setDanmukuConfig=function(e){r.setState({danmukuConfig:s(r.state.danmukuConfig,e)})},r.setPlayerConfig=function(e){r.setState({playerConfig:s(r.state.playerConfig,e)})},r.getBuffered=function(){r.setState({video:s(r.state.video,{bufferedTime:r.video.getBufferedEnd()})})},r.handleOnLoadStart=function(){0===r.state.video.playTimes?r.setState({playerStatus:0,startStatus:s(r.state.startStatus,{video:1})}):r.setState({video:s(r.state.video,{palyTimes:r.state.video.playTimes+1})})},r.handleOnLoadedMetadata=function(e){0===r.state.video.playTimes&&r.setState({video:s(r.state.video,{duration:e})})},r.handleOnLoadedData=function(){0===r.state.video.playTimes&&r.setState({startStatus:s(r.state.startStatus,{video:1})})},r.handleOnCanPaly=function(){0===r.state.video.playTimes&&(r.setState({startStatus:s(r.state.startStatus,{video:2,danmuku:1}),loading:!1}),r.fetchDanmuku()),r.setState({loading:!1})},r.handleOnError=function(e){r.setState({playerStatus:-1,startStatus:s({},r.state.playerTips,{video:3}),message:e})},r.handleOnWaiting=function(){r.setState({loading:!0})},r.handleOnEneded=function(){r.setState({playerStatus:3,playerAction:2})},r.handleControlSucess=function(){},r.handleOnPlay=function(e){var t=r.state.video;e?r.setState({video:s(t,{playTimes:1}),playerStatus:2,playerAction:1,controllerShow:!0,loading:!1}):r.setState({playerAction:1,loading:!1}),r.video.play(),r.startCurrentTimer()},r.handleOnPause=function(){r.setState({playerAction:2}),r.video.pause(),r.clearCurrentTimer()},r.handleOnMouseMove=function(){r.startControlsTimer()},r.fullScreenChange=function(){T.default.isFullscreen()?r.setState({fullScreen:!0}):(r.setState({fullScreen:!1}),r.danmuku.onWindowResize())},r.handleOnFullScreen=function(){T.default.isFullscreen()?T.default.exit():T.default.request(r.player)},r.fetchDanmuku=function(){fetch(r.props.getDanmukuUrl,{method:"POST",headers:{"Content-Type":"application/json"}}).then(function(e){return e.ok?e.json():Promise.reject({retCode:-1,retMsg:"弹幕加载失败"})}).then(function(e){0===e.retCode?r.setState({startStatus:s(r.state.startStatus,{danmuku:2,controller:1}),danmuku:e.retData.danmuku}):r.setState({startStatus:s(r.state.startStatus,{danmuku:3,controller:1})}),r.loadDanmuku()}).catch(function(e){console.error(e),r.setState({startStatus:s(r.state.startStatus,{danmuku:3,controller:1})}),r.loadDanmuku()})},r.sendDanmu=function(e){var t=s({},{content:e,date:new Date,timePoint:r.state.video.currentTime},s({},r.state.danmukuConfig));fetch(r.props.sendDanmukuUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.ok?e.json():Promise.reject({retCode:-1,retMsg:"弹幕发送失败"})}).then(function(e){0===e.retCode?r.danmuku.insertDanmuku(t):console.warn(e.retMsg)}).catch(function(e){console.warn(e)})},r.loadDanmuku=function(){setTimeout(function(){r.setState({startStatus:s(r.state.startStatus,{controller:2})})},500),setTimeout(function(){r.setState({playerStatus:2===r.state.startStatus.video?1:-1,showStart:!1})},1e3)},r.showControls=function(){clearTimeout(r.controlsHideTimer),r.setState({userActivity:!0})},r.hideControls=function(){r.startControlsTimer()},r.startControlsTimer=function(){r.setState({userActivity:!0,cursorShow:!0}),clearTimeout(r.controlsHideTimer),r.controlsHideTimer=setTimeout(function(){var e=!0;T.default.isFullscreen()&&(e=!1),r.setState({userActivity:!1,cursorShow:e})},3e3)},r.startBufferedTimer=function(){r.bufferedTimer||(r.bufferedTimer=setInterval(function(){var e=r.video.getBuffered();r.setState({video:s(r.state.video,{bufferedTime:e})}),e>=r.state.video.duration&&r.clearBufferedTimer()},1e3))},r.clearBufferedTimer=function(){clearInterval(r.bufferedTimer),r.bufferedTimer=null},r.startCurrentTimer=function(){r.currentTimer||(r.currentTimer=setInterval(function(){r.setState({video:s(r.state.video,{currentTime:r.video.getCurrentTime()})})},250))},r.clearCurrentTimer=function(){clearInterval(r.currentTimer),r.currentTimer=null},r.renderStart=function(){var e=r.state,t=e.showStart,n=e.startStatus;return u.default.createElement(h.default,{showStart:t,startStatus:n})},r.renderPlay=function(){var e=r.state.playerStatus;if(1!==e)return null;var t='<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#play_icon" />';return u.default.createElement("button",{className:"play-button",onClick:function(){return r.handleOnPlay(!0)}},u.default.createElement("svg",{className:"play-svg",version:"1.1",fill:"white",dangerouslySetInnerHTML:{__html:t}}))},r.renderPalyer=function(e){var t={loop:r.props.loop,autoPlay:r.props.autoPlay,preload:r.props.preload,poster:r.props.poster,src:r.props.src},n={handleOnLoadStart:r.handleOnLoadStart,handleOnLoadedMetadata:r.handleOnLoadedMetadata,handleOnLoadedData:r.handleOnLoadedData,handleOnCanPaly:r.handleOnCanPaly,handleOnError:r.handleOnError,handleOnWaiting:r.handleOnWaiting,handleOnEneded:r.handleOnEneded},o={handleOnPause:r.handleOnPause,handleOnPlay:r.handleOnPlay,startControlsTimer:r.startControlsTimer,handleProcess:r.handleProcess,handleStopProcess:r.handleStopProcess,handleControlSucess:r.handleControlSucess,setCurrentTime:r.setCurrentTime,showControls:r.showControls,hideControls:r.hideControls,setVolume:r.setVolume,setMuted:r.setMuted,setLoop:r.setLoop,setDanmukuConfig:r.setDanmukuConfig,setPlayerConfig:r.setPlayerConfig,sendDanmu:r.sendDanmu,handleOnFullScreen:r.handleOnFullScreen},a='<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_loading" />',i=r.state.playerConfig.onOff,l=r.state.playerConfig.opacity,c=r.state,d=c.userActivity,p=c.cursorShow,m=c.fullScreen;return u.default.createElement("div",{className:"player-container video-react-container "+(m?"full-screen":"")+" "+(d?"player-user-activity":"player-user-inactivity")+" "+(p?"":"cursor-hide"),style:{paddingTop:e.paddingTop},ref:function(e){return r.player=e},onMouseMove:r.handleOnMouseMove},r.renderStart(),r.renderPlay(),u.default.createElement("div",{style:{display:""+(r.state.playerStatus===-1?"block":"none")}},"Error"),u.default.createElement("svg",{className:"video-loading-svg",style:{display:""+(r.state.loading?"block":"none")},version:"1.1",viewBox:"0 0 44 44",stroke:"#d09500",dangerouslySetInnerHTML:{__html:a}}),i&&u.default.createElement("div",{className:"canvas-container",style:{opacity:l}},u.default.createElement(b.default,{danmuku:r.state.danmuku,playerAction:r.state.playerAction,currentTime:r.state.video.currentTime,loading:r.state.loading,ref:function(e){return r.danmuku=e}})),u.default.createElement(f.default,s({key:"video"},t,n,{ref:function(e){return r.video=e}}),r.props.children),u.default.createElement(v.default,s({video:r.state.video,volume:r.state.volume,controls:r.props.controls,playerAction:r.state.playerAction,show:r.state.controllerShow,danmukuConfig:r.state.danmukuConfig,playerConfig:r.state.playerConfig,fullScreen:r.state.fullScreen},o)))},r.state={showStart:!0,startStatus:{video:0,danmuku:0,controller:0},playerStatus:0,playerAction:0,controllerShow:!1,userActivity:!0,cursorShow:!0,loading:!1,danmuku:[],fullScreen:!1,video:{playTimes:0,duration:0,currentTime:0,bufferedTime:0,volume:r.props.volume,muted:!1,loop:r.props.loop},danmukuConfig:{fontColor:"white",fontSize:"middle",model:"roll"},playerConfig:{opacity:1,scale:"normal",onOff:!0}},r}return i(t,e),t.prototype.componentDidMount=function(){this.video.setVolume(this.props.volume),T.default.addEventListener(this.fullScreenChange),this.startBufferedTimer()},t.prototype.componentWillUnmount=function(){this.clearBufferedTimer(),this.clearCurrentTimer()},t.prototype.render=function(){var e=this.getStyle();return u.default.createElement("div",{className:"ice-player-container"},u.default.createElement(d.default,null),this.renderPalyer(e))},t}(l.Component);E.displayName="IceVideo",E.propTypes={children:l.PropTypes.any,width:l.PropTypes.number,height:l.PropTypes.number,loop:l.PropTypes.bool,autoPlay:l.PropTypes.bool,preload:l.PropTypes.oneOf(["auto","metadata","none"]),volume:l.PropTypes.number,poster:l.PropTypes.string,getDanmukuUrl:l.PropTypes.string.isRequired,sendDanmukuUrl:l.PropTypes.string.isRequired,controls:l.PropTypes.bool,scale:l.PropTypes.string,src:l.PropTypes.string.isRequired},E.defaultProps={autoPlay:!1,preload:"auto",poster:"",loop:!1,volume:.8,controls:!0,scale:"16:9"},t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=n(12),c=r(u),d=function(e){function t(){var n,r,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=a(this,e.call.apply(e,[this].concat(l))),r.onWindowResize=function(){r.dc.resize(r.canvas)},r.insertDanmuku=function(e){r.dc.insertDanmuku(e)},i=n,a(r,i)}return i(t,e),t.prototype.componentDidMount=function(){this.dc=new c.default(this.canvas),this.dc.draw(),window.addEventListener("resize",this.onWindowResize)},t.prototype.shouldComponentUpdate=function(e){return e.currentTime!==this.props.currentTime||e.playerAction!==this.props.playerAction},t.prototype.componentDidUpdate=function(){var e=this.props,t=e.danmuku,n=e.playerAction,r=e.currentTime,o=e.loading;if(1!==n||o)(2===n||o)&&this.dc.stop();else{var a=t.filter(function(e){return e.timePoint>=r&&e.timePoint<r+.25});this.dc.addDanmuku(a),this.dc.draw()}},t.prototype.render=function(){var e=this;return l.default.createElement("canvas",{className:"player-danmuku",ref:function(t){return e.canvas=t}})},t}(s.Component);d.displayName="IcePlayerDanmuku",d.propTypes={danmuku:s.PropTypes.arrayOf(s.PropTypes.shape({content:s.PropTypes.string,date:s.PropTypes.string,timePoint:s.PropTypes.number})),playerAction:s.PropTypes.number,currentTime:s.PropTypes.number,loading:s.PropTypes.bool},t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(0),a=r(o),i=function(){return a.default.createElement("svg",{display:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a.default.createElement("symbol",{id:"video_play",viewBox:"0 0 36 36"},a.default.createElement("path",{d:"M25.8 18c0 .6-.3 1.1-.8 1.3L12.5 27c-.2.1-.5.2-.8.2-.8 0-1.5-.6-1.5-1.5V10c0-.8.7-1.5 1.5-1.5.3 0 .5.1.8.2l12.7 7.9c.4.5.6.9.6 1.4z"})),a.default.createElement("symbol",{id:"video_pause",viewBox:"0 0 36 36"},a.default.createElement("path",{d:"M23.5 28c-.8 0-1.5-.7-1.5-1.5v-17c0-.8.7-1.5 1.5-1.5s1.5.7 1.5 1.5v17c0 .8-.7 1.5-1.5 1.5zm-11 0c-.8 0-1.5-.7-1.5-1.5v-17c0-.8.7-1.5 1.5-1.5s1.5.7 1.5 1.5v17c0 .8-.7 1.5-1.5 1.5z"})),a.default.createElement("symbol",{id:"video_setting",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M21 11v2l-2 1v-.3c-.2.7-.5 1.5-.9 2.1l.2-.2.7 2.1-1.4 1.4-2.1-.7.2-.2c-.7.4-1.4.7-2.1.9h.4l-1 2h-2l-1-2h.3c-.7-.2-1.5-.5-2.1-.9l.2.2-2.1.7-1.4-1.4.7-2.1.2.2c-.4-.7-.7-1.4-.9-2.1v.3l-2-1v-2l2-1v.4c.2-.8.5-1.6 1-2.3l-.3.4-.7-2.2 1.4-1.4 2.1.7-.3.4c.7-.5 1.5-.8 2.3-1H10l1-2h2l1 2h-.4c.8.2 1.6.5 2.3.9l-.3-.3 2.1-.7 1.4 1.4-.7 2.1-.3-.3c.4.7.7 1.4.9 2.2V10l2 1zm-9-4c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5z"})),a.default.createElement("symbol",{id:"video_volume",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M22 12c0 2.2-.8 4.1-2 5.7v.2c0 .5-.4.9-.9 1l-1.3-1.8C19.1 15.8 20 14 20 12c0-2-.8-3.8-2.2-5-.3-.2-.5-.5-.5-.9 0-.6.4-1 1-1 .3 0 .5.1.7.3 1.9 1.6 3 4 3 6.6zm-5.3 3.3c-.1.1-.1.2-.2.2-.2.1-.3.2-.6.2-.6 0-1-.4-1-1 0-.3.2-.6.4-.8.4-.5.6-1.1.6-1.8s-.2-1.3-.6-1.8l.1-.1c-.2-.3-.4-.6-.4-.9 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1.4-.5 2.5-1.3 3.4zM13 3zm-.3 17.7c-.2.2-.4.3-.7.3-.3 0-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h2.8l5.4-3.6c.2-.3.5-.4.8-.4.2 0 .5.1.7.3.2.2.3.4.3.7v16c0 .3-.1.5-.3.7zM11 5.8L6.8 8.6c-.2.3-.5.4-.8.4H4v6h2c.3 0 .6.1.8.4l4.2 2.9V5.8z"})),a.default.createElement("symbol",{id:"video_volume_damping",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M16.7 15.3c-.1.1-.1.2-.2.2-.2.1-.3.2-.6.2-.6 0-1-.4-1-1 0-.3.2-.6.4-.8.4-.5.6-1.1.6-1.8s-.2-1.3-.6-1.8l.1-.1c-.2-.3-.4-.6-.4-.9 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1.4-.5 2.5-1.3 3.4zm-4 5.4c-.2.2-.4.3-.7.3s-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h2.8l5.4-3.6c.2-.3.5-.4.8-.4.2 0 .5.1.7.3s.3.4.3.7v16c0 .3-.1.5-.3.7zM11 5.8L6.8 8.6c-.2.3-.5.4-.8.4H4v6h2c.3 0 .6.1.8.4l4.2 2.9V5.8z"})),a.default.createElement("symbol",{id:"video_volume_mute",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M20.2 17.4L18.8 16c.8-1.1 1.2-2.5 1.2-3.9 0-2-.8-3.8-2.2-5-.3-.2-.5-.5-.5-.9 0-.6.4-1 1-1 .3 0 .5.1.7.3 1.8 1.6 3 4 3 6.7 0 1.8-.7 3.7-1.8 5.2zm-2.9-2.9L15.8 13c.1-.3.2-.6.2-1 0-.7-.2-1.3-.6-1.8l.1-.1c-.3-.2-.5-.5-.5-.8 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1-.3 1.9-.7 2.6zM13 3zm-2 2.8l-1.4 1-1.4-1.4 3-2c.2-.3.5-.4.8-.4.2 0 .5.1.7.3.2.2.3.4.3.7v6.2l-2-2V5.8zm9.7 14.9c-.4.4-1 .4-1.4 0l-16-16c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l16 16c.4.4.4 1 0 1.4zM4.2 7l2 2H4v6h2c.3 0 .6.1.8.4l4.2 2.8v-4.4l2 2V20c0 .2-.1.5-.3.7-.2.2-.4.3-.7.3-.3 0-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h1.2z"})),a.default.createElement("symbol",{id:"video_fullscreen",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M19.7 19.7c-.2.2-.5.3-.7.3h-4c-.6 0-1-.4-1-1s.4-1 1-1h1.6l-3.3-3.3c-.4-.4-.3-1.1.1-1.4.4-.4 1-.4 1.4 0l3.3 3.3V15c0-.6.4-1 1-1s1 .4 1 1v4c-.1.2-.2.5-.4.7zM19 10c-.6 0-1-.4-1-1V7.4l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L16.6 6H15c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .6-.4 1-1 1zM7.4 18H9c.6 0 1 .4 1 1s-.4 1-1 1H5c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7v-4c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L7.4 18zm1.9-7.3L6 7.4V9c0 .6-.4 1-1 1s-1-.4-1-1V5c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3h4c.6 0 1 .4 1 1s-.4 1-1 1H7.4l3.3 3.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0z"})),a.default.createElement("symbol",{id:"video_fullscreen_true",viewBox:"0 0 24 24"},a.default.createElement("path",{d:"M16.4 9H18c.6 0 1 .4 1 1s-.4 1-1 1h-4c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7V6c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L16.4 9zM10 19c-.6 0-1-.4-1-1v-1.6l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L7.6 15H6c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .5-.4 1-1 1zm0-8H6c-.6 0-1-.4-1-1s.4-1 1-1h1.6L4.3 5.7c-.4-.4-.4-1 .1-1.4.4-.4 1-.4 1.4 0L9 7.6V6c0-.6.4-1 1-1s1 .4 1 1v4c0 .3-.1.5-.3.7-.2.2-.5.3-.7.3zm4 2h4c.6 0 1 .4 1 1s-.4 1-1 1h-1.6l3.3 3.3c.4.4.4 1 0 1.4s-1 .4-1.4 0L15 16.4V18c0 .6-.4 1-1 1s-1-.4-1-1v-4c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3z"})),a.default.createElement("symbol",{id:"play_icon",viewBox:"0 0 100 100"},a.default.createElement("path",{d:"M 18.56 10.20 Q 12.5,6.599 12.5,13.70 L 12.5 86.30 Q 12.5,94.301 18.56,89.80 L 81.44 53.50 Q 87.5,50 81.44,46.50 Z",transform:"scale(1)",fill:"white"})),a.default.createElement("symbol",{id:"video_repeat_true",viewBox:"0 0 36 36"},a.default.createElement("path",{d:"M5.5 10.5L0.1 15.5L3.5 15.5L3.5 18.5Q3.5 30.5, 13.5 30.5L26 30.5L24.5 29Q23 27.5, 21.5 27.5L17 27.5Q7.5 27.5, 7.5 18L7.5 15.5L10.9 15.5 Z"}),a.default.createElement("path",{d:"M30.5 25.5L35.9 20.5L32.5 20.5L32.5 15.5Q32.5 5.5, 22 5.5L10 5.5L11.5 7Q13 8.5, 14.5 8.5L19 8.5Q28.5 8.5, 28.5 18L28.5 20.5L25.1 20.5 Z"})),a.default.createElement("symbol",{id:"video_repeat_false",viewBox:"0 0 36 36"},a.default.createElement("path",{d:"M5.5 10.5L0.1 15.5L3.5 15.5L3.5 18.5Q3.5 30.5, 13.5 30.5L26 30.5L24.5 29Q23 27.5, 21.5 27.5L17 27.5Q7.5 27.5, 7.5 18L7.5 15.5L10.9 15.5 Z"}),a.default.createElement("path",{d:"M30.5 25.5L35.9 20.5L32.5 20.5L32.5 15.5Q32.5 5.5, 22 5.5L10 5.5L11.5 7Q13 8.5, 14.5 8.5L19 8.5Q28.5 8.5, 28.5 18L28.5 20.5L25.1 20.5 Z"}),a.default.createElement("path",{d:"M5.5 7.7L30.5 31.2L30.5 28.3L5.5 4.2Z"})),a.default.createElement("symbol",{id:"danmuku-roll",viewBox:"0 0 48 48"},a.default.createElement("rect",{x:"12",y:"20",width:"18",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"32",y:"20",width:"3",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"3",y:"24",width:"20",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"25",y:"24",width:"13",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"40",y:"24",width:"4",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"10",y:"28",width:"14",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"26",y:"28",width:"6",height:"2",style:{fill:"white"}})),a.default.createElement("symbol",{id:"danmuku-top",viewBox:"0 0 48 48"},a.default.createElement("rect",{x:"10",y:"8",width:"28",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"18",y:"12",width:"12",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"16",y:"16",width:"16",height:"2",style:{fill:"white"}})),a.default.createElement("symbol",{id:"danmuku-bottom",viewBox:"0 0 48 48"},a.default.createElement("rect",{x:"10",y:"40",width:"28",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"18",y:"36",width:"12",height:"2",style:{fill:"white"}}),a.default.createElement("rect",{x:"16",y:"32",width:"16",height:"2",style:{fill:"white"}})),a.default.createElement("symbol",{id:"video_loading",viewBox:"0 0 44 44"},a.default.createElement("g",{fill:"none",fillRule:"evenodd",strokeWidth:"2"},a.default.createElement("circle",{cx:"22",cy:"22",r:"1"},a.default.createElement("animate",{attributeName:"r",begin:"0s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"stroke-opacity",begin:"0s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})),a.default.createElement("circle",{cx:"22",cy:"22",r:"1"},a.default.createElement("animate",{attributeName:"r",begin:"-0.9s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"stroke-opacity",begin:"-0.9s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})))),a.default.createElement("symbol",{id:"loading_start",viewBox:"0 0 135 140",width:"135",height:"140"},a.default.createElement("rect",{y:"10",width:"15",height:"120",rx:"6"},a.default.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),a.default.createElement("rect",{x:"30",y:"10",width:"15",height:"120",rx:"6"},a.default.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),a.default.createElement("rect",{x:"60",width:"15",height:"140",rx:"6"},a.default.createElement("animate",{attributeName:"height",begin:"0s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"y",begin:"0s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),a.default.createElement("rect",{x:"90",y:"10",width:"15",height:"120",rx:"6"},a.default.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),a.default.createElement("rect",{x:"120",y:"10",width:"15",height:"120",rx:"6"},a.default.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),a.default.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"}))))};i.displayName="IcePlayerSVG",t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(0),a=r(o),i=function(e){var t=e.video,n=e.danmuku,r=e.controller,o=["","","[完成]","[失败]"];return a.default.createElement("div",{className:"loading-tips-container"},a.default.createElement("ul",null,a.default.createElement("li",{style:{visibility:""+(0===t?"hidden":"visible")}},"视屏核动力注入...",a.default.createElement("i",null,o[t])),a.default.createElement("li",{style:{visibility:""+(0===n?"hidden":"visible")}},"主武器弹幕装填...",a.default.createElement("i",null,o[n])),a.default.createElement("li",{style:{visibility:""+(0===r?"hidden":"visible")}},"驾驶舱神经同步...",a.default.createElement("i",null,o[r])),a.default.createElement("li",{style:{visibility:""+(0===r||1===r?"hidden":"visible")}},3===t?"初号机启动失败.":"初号机就绪.")))},s=function(e){var t=e.startStatus,n=e.showStart,r='<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#loading_start" />';return a.default.createElement("div",{className:"player-loading",style:{display:""+(n?"block":"none")}},a.default.createElement("svg",{className:"loading-icon",version:"1.1",fill:"white",dangerouslySetInnerHTML:{__html:r}}),i(t))};s.displayName="IceVideoStart",s.propTypes={showStart:o.PropTypes.bool.isRequired,startStatus:o.PropTypes.shape({video:o.PropTypes.oneOf([0,1,2,3]),barrage:o.PropTypes.oneOf([0,1,2,3]),controller:o.PropTypes.oneOf([0,1,2,3])})},t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.onLoadStart=function(){r.props.handleOnLoadStart()},r.onLoadedMetaData=function(){var e=r.video.duration;r.props.handleOnLoadedMetadata(e)},r.onLoadedData=function(){r.props.handleOnLoadedData()},r.onWaiting=function(){r.props.handleOnWaiting()},r.onCanPlay=function(){r.props.handleOnCanPaly()},r.onError=function(){var e=r.video.error;r.props.handleOnError(e)},r.getBuffered=function(){var e=r.video.buffered,t=0;try{t=e.end(0)||0,t=parseInt(1e3*t+1,10)/1e3}catch(e){}return t},r.getCurrentTime=function(){return r.video.currentTime},r.setCurrentTime=function(e){r.video.currentTime=e},r.setLoop=function(e){r.video.loop=e},r.setMuted=function(e){r.video.muted=e},r.setVolume=function(e){r.video.volume=e},r.play=function(){r.video.play()},r.pause=function(){r.video.pause()},r.video=null,r}return i(t,e),t.prototype.shouldComponentUpdate=function(e){return e.src!==this.props.src},t.prototype.render=function(){var e=this;return l.default.createElement("video",{className:"react-video",src:this.props.src,loop:this.props.loop,autoPlay:this.props.autoPlay,preload:this.props.preload,poster:this.props.poster,ref:function(t){return e.video=t},onCanPlay:this.onCanPlay,onError:this.onError,onLoadStart:this.onLoadStart,onLoadedMetadata:this.onLoadedMetaData,onLoadedData:this.onLoadedData,onWaiting:this.onWaiting,onProgress:this.onProgress,onPlay:this.onPlay,onEnded:this.handleOnEnded})},t}(s.Component);u.displayName="IcePlayerVideo",u.propTypes={src:s.PropTypes.string,loop:s.PropTypes.bool,autoPlay:s.PropTypes.bool,preload:s.PropTypes.string,poster:s.PropTypes.string,handleOnLoadStart:s.PropTypes.func.isRequired,handleOnLoadedMetadata:s.PropTypes.func.isRequired,handleOnLoadedData:s.PropTypes.func.isRequired,handleOnCanPaly:s.PropTypes.func.isRequired,handleOnWaiting:s.PropTypes.func.isRequired,handleOnError:s.PropTypes.func.isRequired},u.defaultProps={autoPlay:!1,preload:"auto",loop:!1,volume:.8,controls:!0},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=["white","black","ghostwhite","snow","whitesmoke","silver","darkgray","grey","dimgray","lavender","skyblue","royalblue","mediumblue","purple","blue","steelblue","darkblue","navy","blueviolet","lightpink","pink","hotpink","peachpuff","deeppink","mediumvioletred","red","crimson","firebrick","darkred","aquamarine","mediumaquamarine","cyan","springgreen","lightgreen","seagreen","forestgreen","limegreen","green","darkgreen","ivory","wheat","lemonchiffon","khaki","bisque","lightgoldenrodyellow","Yellow","gold","goldenrod","orange","tan","lightcoral","peru","olivedrab","chocolate","sienna","brown","saddlebrown","dimgray","maroon"],c=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=r.getLeft(e.offsetParent)),t},r.setMenu=function(e){return function(){r.setState({menu:e})}},r.setOpacity=function(e){e.preventDefault(),r.state.dragOpacity&&r.setState({dragOpacity:!1})},r.setOnOff=function(e){return function(){r.props.setPlayerConfig(e)}},r.hanldeOnDanmuku=function(e){return function(){r.props.setDanmukuConfig(e)}},r.handleOnIndicatorMouseDown=function(e){e.preventDefault();var t=r.opacityBar.offsetWidth,n=r.getLeft(r.opacityBar);r.setState({dragOpacity:!0,dragOpacityWidth:r.computeLeftX(e.clientX,n,t)/t})},r.handleOnOpacityMouseMove=function(e){if(e.preventDefault(),r.state.dragOpacity){var t=r.opacityBar.offsetWidth,n=r.getLeft(r.opacityBar),o=r.computeLeftX(e.clientX,n,t)/t;r.setState({dragOpacityWidth:o}),r.props.setPlayerConfig({opacity:o})}},r.handleOnOpacityBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=r.opacityBar.offsetWidth,n=r.getLeft(r.opacityBar);r.props.setPlayerConfig({opacity:r.computeLeftX(e.clientX,n,t)/t})},r.computeLeftX=function(e,t,n){var r=void 0;return r=e<t?0:e>t+n?n:e-t},r.state={menu:"danmuku",dragOpacity:!1,dragOpacityWidth:0},r}return i(t,e),t.prototype.shouldComponentUpdate=function(e,t){return e!==this.props||t!==this.state},t.prototype.render=function(){var e=this,t=this.state,n=t.menu,r=t.dragOpacity,o=t.dragOpacityWidth,a=this.props.danmukuConfig,i=a.model,s=a.fontSize,c=a.fontColor,d=this.props.playerConfig,p=d.opacity,f=d.onOff,m='<use class="model-roll-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-roll" />',h='<use class="model-top-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-top" />',y='<use class="model-bottom-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-bottom" />';return l.default.createElement("div",{className:"video-config-container"},l.default.createElement("div",{className:"video-config","data-status":n},l.default.createElement("div",{className:"video-config-bar"},l.default.createElement("ul",null,l.default.createElement("li",{className:"danmuku-li",onClick:this.setMenu("danmuku")},"弹幕设置"),l.default.createElement("li",{className:"player-li",onClick:this.setMenu("player")},"播放器设置"))),l.default.createElement("div",{className:"video-config-content"},l.default.createElement("div",{className:"config-group danmuku-group"},l.default.createElement("div",{className:"config-item danmuku-font","data-status":s},l.default.createElement("span",{className:"row-title"},"字号"),l.default.createElement("div",{className:"row-selection"},l.default.createElement("span",{className:"selection-name small",onClick:this.hanldeOnDanmuku({fontSize:"small"})},"小"),l.default.createElement("span",{className:"selection-name middle",onClick:this.hanldeOnDanmuku({fontSize:"middle"})},"中"),l.default.createElement("span",{className:"selection-name large",onClick:this.hanldeOnDanmuku({fontSize:"large"})},"大"))),l.default.createElement("div",{className:"config-item danmuku-model","data-status":i},l.default.createElement("span",{className:"row-title"},"模式"),l.default.createElement("div",{
className:"row-selection"},l.default.createElement("div",{className:"selection-span model-roll",onClick:this.hanldeOnDanmuku({model:"roll"})},l.default.createElement("svg",{className:"model-svg model-roll-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:m}}),l.default.createElement("span",{className:"selection-name roll"},"滚动")),l.default.createElement("div",{className:"selection-span model-top",onClick:this.hanldeOnDanmuku({model:"top"})},l.default.createElement("svg",{className:"model-svg model-top-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:h}}),l.default.createElement("span",{className:"selection-name top"},"顶部")),l.default.createElement("div",{className:"selection-span model-bottom",onClick:this.hanldeOnDanmuku({model:"bottom"})},l.default.createElement("svg",{className:"model-svg model-bottom-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:y}}),l.default.createElement("span",{className:"selection-name bottom"},"底部")))),l.default.createElement("div",{className:"config-item danmuku-color","data-status":c},l.default.createElement("span",{className:"row-title"},"颜色"),l.default.createElement("div",{className:"row-selection"},u.map(function(t){return l.default.createElement("span",{className:"color-item "+(c===t?"active":""),key:t,style:{backgroundColor:t},onClick:e.hanldeOnDanmuku({fontColor:t})})})))),l.default.createElement("div",{className:"config-group player-group"},l.default.createElement("div",{className:"config-item danmuku-opacity"},l.default.createElement("span",{className:"row-title"},"透明"),l.default.createElement("div",{className:"row-selection",onMouseMove:this.handleOnOpacityMouseMove,onMouseLeave:this.setOpacity,onMouseUp:this.setOpacity},l.default.createElement("div",{className:"opacity-bar",ref:function(t){return e.opacityBar=t},onClick:this.handleOnOpacityBarClick},l.default.createElement("div",{className:"opacity-bar-level",style:{width:(r?100*o:100*p)+"%"}},l.default.createElement("button",{className:"opacity-bar-indicator",onMouseDown:this.handleOnIndicatorMouseDown,onMouseUp:this.setOpacity}))))),l.default.createElement("div",{className:"config-item player-on-off","data-status":""+(f?"on":"off")},l.default.createElement("span",{className:"row-title"},"弹幕"),l.default.createElement("div",{className:"row-selection"},l.default.createElement("span",{className:"selection-name on",onClick:this.setOnOff({onOff:!0})},"开"),l.default.createElement("span",{className:"selection-name off",onClick:this.setOnOff({onOff:!1})},"关"))),l.default.createElement("div",{className:"config-item player-size","data-status":"normal"},l.default.createElement("span",{className:"row-title"},"比例"),l.default.createElement("div",{className:"row-selection"},l.default.createElement("span",{className:"selection-name normal"},"16:9")))))))},t}(s.Component);c.displayName="IcePlayerControllerConfig",c.propTypes={danmukuConfig:s.PropTypes.shape({fontColor:s.PropTypes.string,fontSize:s.PropTypes.oneOf(["small","middle","large"]),model:s.PropTypes.oneOf(["roll","top","bottom"])}),playerConfig:s.PropTypes.shape({opacity:s.PropTypes.number,scale:s.PropTypes.string,onOff:s.PropTypes.bool}),setDanmukuConfig:s.PropTypes.func.isRequired,setPlayerConfig:s.PropTypes.func.isRequired},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=n(10),c=r(u),d=n(9),p=r(d),f=n(11),m=r(f),h=n(7),y=r(h),v=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.handleOnPlayIcon=function(){var e=r.props,t=e.playerAction,n=e.startControlsTimer;n(),1===t?r.props.handleOnPause():r.props.handleOnPlay(!1)},r.handleOnRepeatClick=function(e){e.preventDefault();var t=void 0;t=!r.props.video.loop,r.props.setLoop(t)},r.handleOnSetting=function(){var e=r.state.showConfig,t=!1;e||(t=!0),r.setState({showConfig:t})},r.handleOnFullScreenClick=function(){r.props.handleOnFullScreen()},r.computeLeftX=function(e,t,n){var r=void 0;return r=e<t?0:e>t+n?n:e-t},r.state={showConfig:!1},r}return i(t,e),t.prototype.shouldComponentUpdate=function(e,t){return e!==this.props||t!==this.state},t.prototype.render=function(){var e=this.props,t=e.controls,n=e.playerAction,r=e.show,o=e.video;if(!t)return null;var a='<use class="video-svg-play video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_play" /><use class="video-svg-pause video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_pause" />',i='<use class="video-svg-fullscreen video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_fullscreen" /><use class="video-svg-fullscreen-true video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_fullscreen_true" />',s='<use class="" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_setting" />',u='<use class="video-svg-repeat-true video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_repeat_true" /><use class="video-svg-repeat-false video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_repeat_false" />',d="";1===n||3===n?d="pause":2===n&&(d="play");var f=this.state.showConfig?"show":"hide",h=this.props.fullScreen;return l.default.createElement("div",{className:"video-control-main "+(r?"":"video-control-main-hidden")},l.default.createElement(c.default,{currentTime:this.props.video.currentTime,bufferedTime:this.props.video.bufferedTime,duration:this.props.video.duration,setCurrentTime:this.props.setCurrentTime}),l.default.createElement("div",{className:"video-control-bar"},l.default.createElement("button",{className:"video-control-item video-btn-play","data-status":d,"aria-label":"播放/暂停",onClick:this.handleOnPlayIcon},l.default.createElement("svg",{className:"video-svg",version:"1.1",viewBox:"0 0 36 36",dangerouslySetInnerHTML:{__html:a}})),l.default.createElement(p.default,{showControls:this.props.showControls,hideControls:this.props.hideControls,sendDanmu:this.props.sendDanmu}),l.default.createElement("div",{className:"video-control-bar-right","data-config":f},l.default.createElement(m.default,{video:this.props.video,volume:this.props.video.volume,muted:this.props.video.muted,setVolume:this.props.setVolume,setMuted:this.props.setMuted}),l.default.createElement("button",{className:"video-control-item video-btn-setting","aria-label":"设置","data-config":f,onClick:this.handleOnSetting},l.default.createElement("svg",{className:"video-svg",version:"1.1",viewBox:"0 0 36 36",dangerouslySetInnerHTML:{__html:s}})),l.default.createElement("button",{className:"video-control-item video-btn-repeat","aria-label":"循环","data-status":o.loop,"data-msg":""+(o.loop?"关闭循环":"洗脑循环"),onClick:this.handleOnRepeatClick},l.default.createElement("svg",{className:"video-svg",version:"1.1",viweBox:"0 0 24 24",dangerouslySetInnerHTML:{__html:u}})),l.default.createElement("button",{className:"video-control-item video-btn-fullscreen","aria-label":"全屏","data-status":h,onClick:this.handleOnFullScreenClick},l.default.createElement("svg",{className:"video-svg",version:"1.1",viewBox:"0 0 24 24",dangerouslySetInnerHTML:{__html:i}})),l.default.createElement(y.default,{danmukuConfig:this.props.danmukuConfig,playerConfig:this.props.playerConfig,setDanmukuConfig:this.props.setDanmukuConfig,setPlayerConfig:this.props.setPlayerConfig}))))},t}(s.Component);v.displayName="IcePlayerController",v.propTypes={controls:s.PropTypes.bool.isRequired,playerAction:s.PropTypes.number.isRequired,show:s.PropTypes.bool.isRequired,video:s.PropTypes.shape({playTimes:s.PropTypes.number.isRequired,duration:s.PropTypes.number.isRequired,currentTime:s.PropTypes.number.isRequired,fullScreen:s.PropTypes.number.isRequired,bufferedTime:s.PropTypes.number.isRequired,volume:s.PropTypes.number.isRequired,muted:s.PropTypes.bool.isRequired,loop:s.PropTypes.bool.isRequired}),fullScreen:s.PropTypes.bool,danmukuConfig:s.PropTypes.shape({fontColor:s.PropTypes.string,fontSize:s.PropTypes.oneOf(["small","middle","large"]),model:s.PropTypes.oneOf(["roll","top","bottom"])}),playerConfig:s.PropTypes.shape({opacity:s.PropTypes.number,scale:s.PropTypes.string,onOff:s.PropTypes.bool}),handleOnPause:s.PropTypes.func.isRequired,handleOnPlay:s.PropTypes.func.isRequired,startControlsTimer:s.PropTypes.func.isRequired,setCurrentTime:s.PropTypes.func.isRequired,showControls:s.PropTypes.func.isRequired,hideControls:s.PropTypes.func.isRequired,setVolume:s.PropTypes.func.isRequired,setMuted:s.PropTypes.func.isRequired,setLoop:s.PropTypes.func.isRequired,setDanmukuConfig:s.PropTypes.func.isRequired,setPlayerConfig:s.PropTypes.func.isRequired,sendDanmu:s.PropTypes.func.isRequired,handleOnFullScreen:s.PropTypes.func.isRequired},t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=function(e){function t(){var n,r,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=a(this,e.call.apply(e,[this].concat(l))),r.handleOnInputFocus=function(){r.props.showControls()},r.handleOnInputBlur=function(){r.props.hideControls()},r.handleOnInputKeyUp=function(e){r.props.showControls(),13===e.keyCode&&(r.props.sendDanmu(r.input.value),r.input.value="")},i=n,a(r,i)}return i(t,e),t.prototype.shouldComponentUpdate=function(){return!1},t.prototype.render=function(){var e=this;return l.default.createElement("div",{className:"video-control-item video-control-input"},l.default.createElement("input",{className:"video-danmuku-input",type:"text",placeholder:"发个弹幕吐槽吧...",ref:function(t){return e.input=t},onFocus:this.handleOnInputFocus,onBlur:this.handleOnInputBlur,onKeyUp:this.handleOnInputKeyUp}))},t}(s.Component);u.displayName="IcePlayerControllerDanmukuInput",u.propTypes={showControls:s.PropTypes.func.isRequired,hideControls:s.PropTypes.func.isRequired,sendDanmu:s.PropTypes.func.isRequired},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=n(13),c=r(u),d=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=r.getLeft(e.offsetParent)),t},r.processMouseMove=function(e){e.preventDefault();var t=r.processBar.offsetWidth,n=r.getLeft(r.processBar),o=r.computeLeftX(e.clientX,n,t);r.setState({processMouseLeft:o,processMouseDispaly:!0}),r.state.dragProgress&&r.setState({dragProgressWidth:o/t*100}),r.hideProcessMouse()},r.processMouseUp=function(e){if(e.preventDefault(),r.state.dragProgress){var t=r.state.dragProgressWidth/100*r.props.duration;r.props.setCurrentTime(t),r.setState({dragProgress:!1})}},r.processMouseLeave=function(){if(clearTimeout(r.hideProcessMouseTimer),r.setState({processMouseDispaly:!1,dragProgress:!1}),r.state.dragProgress){var e=r.state.dragProgressWidth/100*r.props.duration;r.props.setCurrentTime(e),r.setState({dragProgress:!1})}},r.processScrubberMoveDown=function(e){e.preventDefault();var t=r.processBar.offsetWidth,n=r.getLeft(r.processBar);r.setState({dragProgress:!0,dragProgressWidth:r.computeLeftX(e.clientX,n,t)/t*100})},r.processBarMouseDown=function(e){e.preventDefault(),e.stopPropagation()},r.processBarMouseUp=function(e){e.preventDefault(),e.stopPropagation()},r.processBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=r.processBar.offsetWidth,n=r.getLeft(r.processBar),o=r.computeLeftX(e.clientX,n,t)/t*r.props.duration;r.props.setCurrentTime(o)},r.hideProcessMouse=function(){clearTimeout(r.hideProcessMouseTimer),r.hideProcessMouseTimer=setTimeout(function(){r.setState({processMouseDispaly:!1})},1500)},r.computeLeftX=function(e,t,n){var r=void 0;return r=e<t?0:e>t+n?n:e-t},r.state={processMouseLeft:0,processMouseDispaly:!1,dragProgress:!1,dragProgressWidth:0,dragVolume:!1,dragVolumeWidth:0},r}return i(t,e),t.prototype.shouldComponentUpdate=function(e,t){var n=e.duration,r=e.currentTime,o=e.bufferedTime;return n!==this.props.duration||r!==this.props.currentTime||o!==this.props.bufferedTime||t!==this.state},t.prototype.componentWillUnmount=function(){clearTimeout(this.hideProcessMouseTimer)},t.prototype.render=function(){var e=this,t=this.props,n=t.currentTime,r=t.bufferedTime,o=t.duration,a=this.state,i=a.processMouseLeft,s=a.processMouseDispaly,u=a.dragProgress,d=a.dragProgressWidth;return l.default.createElement("div",{className:"video-progress","aria-label":"进度轴"},l.default.createElement("div",{className:"video-time-display"},l.default.createElement("span",{className:"video-time"},(0,c.default)(n))),l.default.createElement("div",{className:"video-progress-bar","aria-label":"进度条",ref:function(t){return e.processBar=t},onMouseMove:this.processMouseMove,onMouseLeave:this.processMouseLeave,onMouseUp:this.processMouseUp},l.default.createElement("span",{className:"video-process-list",onClick:this.processBarClick,onMouseDown:this.processBarMouseDown,onMouseUp:this.processBarMouseUp},l.default.createElement("div",{className:"video-process-load",style:{width:r/o*100+"%"}}),l.default.createElement("span",{className:"video-process-mouse-display "+(s?"video-process-mouse-display-show":""),"data-time":""+(s?(0,c.default)(i/this.processBar.offsetWidth*o):0),style:{left:i+"px"}}),l.default.createElement("div",{className:"video-process-play",style:{width:(u?d:n/o*100)+"%"}},l.default.createElement("button",{className:"video-process-scrubber-indicator",onMouseDown:this.processScrubberMoveDown,onMouseUp:this.processMouseUp})))),l.default.createElement("div",{className:"video-time-display"},l.default.createElement("span",{className:"video-time"},(0,c.default)(o))))},t}(s.Component);d.displayName="IcePlayerControllerProcess",d.propTypes={duration:s.PropTypes.number.isRequired,currentTime:s.PropTypes.number.isRequired,bufferedTime:s.PropTypes.number.isRequired,setCurrentTime:s.PropTypes.func.isRequired},t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),l=r(s),u=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=r.getLeft(e.offsetParent)),t},r.setVolume=function(e){e.preventDefault(),r.state.dragVolume&&r.setState({dragVolume:!1})},r.handleOnVolumeIndicatorMouseDown=function(e){e.preventDefault();var t=r.volumeBar.offsetWidth,n=r.getLeft(r.volumeBar),o=r.computeLeftX(e.clientX,n,t)/t;r.setState({dragVolume:!0,dragVolumeWidth:o})},r.handleOnVolumeMouseMove=function(e){if(e.preventDefault(),r.state.dragVolume){var t=r.volumeBar.offsetWidth,n=r.getLeft(r.volumeBar),o=r.computeLeftX(e.clientX,n,t)/t;r.setState({dragVolumeWidth:o}),r.props.setVolume(o)}},r.handleOnVolumeBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=r.volumeBar.offsetWidth,n=r.getLeft(r.volumeBar);r.props.setVolume(r.computeLeftX(e.clientX,n,t)/t)},r.handleOnVolumeIconClick=function(e){e.preventDefault();var t=void 0;t=!r.props.muted,r.props.setMuted(t)},r.computeLeftX=function(e,t,n){var r=void 0;return r=e<t?0:e>t+n?n:e-t},r.state={dragVolume:!1,dragVolumeWidth:0},r}return i(t,e),t.prototype.shouldComponentUpdate=function(e){var t=e.volume,n=e.muted;return t!==this.props.volume||n!==this.props.muted},t.prototype.render=function(){var e=this,t=this.props,n=t.volume,r=t.muted,o=this.state,a=o.dragVolume,i=o.dragVolumeWidth,s='<use class="video-svg-volume video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume" /><use class="video-svg-volume-damping video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume_damping" /><use class="video-svg-volume-mute video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume_mute" />',u="";return u=n>=.5?"normal":n<.5&&n>0?"damping":"mute",r&&(u="mute"),l.default.createElement("div",{className:"video-control-item video-btn-volume","aria-label":"音量","data-status":u,onMouseMove:this.handleOnVolumeMouseMove,onMouseLeave:this.setVolume,onMouseUp:this.setVolume},l.default.createElement("svg",{className:"video-svg",version:"1.1",viewBox:"0 0 24 24",dangerouslySetInnerHTML:{__html:s},onClick:this.handleOnVolumeIconClick}),l.default.createElement("div",{className:"video-btn-volume-bar",ref:function(t){return e.volumeBar=t},onClick:this.handleOnVolumeBarClick},l.default.createElement("div",{className:"video-btn-volume-bar-level",style:{width:(a?100*i:100*n)+"%"}},l.default.createElement("button",{className:"video-btn-volume-bar-indicator",onMouseDown:this.handleOnVolumeIndicatorMouseDown,onMouseUp:this.setVolume}))))},t}(s.Component);u.displayName="IcePlayerControllerVolume",u.propTypes={volume:s.PropTypes.number.isRequired,muted:s.PropTypes.bool.isRequired,setVolume:s.PropTypes.func.isRequired,setMuted:s.PropTypes.func.isRequired},t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function e(t){if(r(this,e),i.call(this),this.isSupport=!0,!t.getContext)return this.isSupport=!1,void console.warn("浏览器不支持canvas");var n=t.parentNode;if(!this.canvasWidth){var o=n.clientWidth,a=n.clientHeight;this.canvasWidth=o,this.canvasHeight=a,t.width=o,t.height=a,t.style.width=o,t.style.height=a}var s=t.getContext("2d");this.fixCanvas(t),this.ctx=s,this.canvas=t,this.clearCanvas(),this.danmukuArr=[],this.col=Math.floor(t.height/30)},i=function(){var e=this;this.clearCanvas=function(){e.ctx.clearRect(0,0,e.canvasWidth,e.canvasHeight)},this.fixCanvas=function(e){var t=e.getContext("2d"),n=window.devicePixelRatio||1,r=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,o=n/r;if(n!==r){var a=e.width,i=e.height;e.width=a*o,e.height=i*o,e.style.width=a+"px",e.style.height=i+"px",t.scale(o,o)}},this.resize=function(t){var n=t.parentNode,r=n.clientWidth,o=n.clientHeight;e.canvasWidth=r,e.canvasHeight=o,t.width=r,t.height=o,t.style.width=r,t.style.height=o,e.fixCanvas(t),e.col=Math.floor(t.height/30)},this.getFont=function(e){var t=void 0;switch(e){case"small":t="14";break;case"middle":t="20";break;case"large":t="26";break;default:t="20"}return t+"px Arial normal"},this.draw=function(){e.isSupport&&(e.timer||(e.timer=setInterval(function(){e.clearCanvas(),e.ctx.save();for(var t=e.danmukuArr,n=0,r=t.length;n<r;n+=1)if(t[n].status){var o=t[n],a=o.content,i=o.x,s=o.y;switch(e.ctx.fillStyle=t[n].fontColor,e.ctx.font=e.getFont(t[n].fontSize),e.ctx.fillText(a,i,s),t[n].insert&&(e.ctx.strokeStyle="white",e.ctx.lineCap="square",e.ctx.beginPath(),e.ctx.moveTo(i,s+3),e.ctx.lineTo(i+t[n].textWidth,s+3),e.ctx.stroke(),e.ctx.closePath()),t[n].model){case"roll":e.danmukuArr[n].x=t[n].x-t[n].speed,t[n].x<=-t[n].textWidth&&(e.danmukuArr[n].status=!1);break;case"top":case"bottom":e.danmukuArr[n].current=e.danmukuArr[n].current+30,t[n].current>=5e3&&(e.danmukuArr[n].status=!1);break;default:e.danmukuArr[n].x=t[n].x-t[n].speed,t[n].x<=-t[n].textWidth&&(e.danmukuArr[n].status=!1)}}e.ctx.restore()},30)))},this.formatData=function(t,n){var r=void 0,a=void 0,i=parseInt(Math.random()*(e.col-1)+1,10);e.ctx.font=e.getFont(t.fontSize);var s=e.ctx.measureText(t.content).width,l=s+e.canvasWidth;switch(t.model){case"roll":r=e.canvas.width,a=30*i;break;case"top":r=e.canvas.width/2-s/2,a=20*i;break;case"bottom":r=e.canvas.width/2-s/2,a=30*e.col-10*i;break;default:r=e.canvas.width,a=30*parseInt(Math.random()*(e.col-1)+1,10)}var u=o({},t,{x:r,y:a,textWidth:s,speed:l/165,insert:n,current:0,status:!0});return u},this.addDanmuku=function(t){var n=t.map(function(t){var n=e.formatData(t,!1);return n});e.danmukuArr=e.danmukuArr.concat(n)},this.insertDanmuku=function(t){var n=e.formatData(t,!0);e.danmukuArr.push(n)},this.stop=function(){clearInterval(e.timer),e.timer=null}};t.default=a},function(e,t,n){"use strict";function r(e){var t=parseInt(e,10),n=0,r=0,o=void 0;return t<60?o=t<10?"0:0"+t:"0:"+t:t<3600?(n=Math.floor(t/60),t%=60,o=t<10?n+":0"+t:n+":"+t):(r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),t%=60,n<10&&t<10?o=r+":0"+n+":0"+t:n<10&&t>=10?o=r+":0"+n+":"+t:n>=10&&t<10?o=r+":"+n+":0"+t:n>=10&&t>=10&&(o=r+":"+n+":"+t)),o}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function e(){r(this,e),this.request=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},this.exit=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},this.isFullscreen=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},this.isEnabled=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled},this.addEventListener=function(e){document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e)},this.removeEventListener=function(e){document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}};t.default=new o},function(e,t,n){n(16),e.exports=self.fetch.bind(self)},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return v.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function a(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function i(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function s(e){var t=new FileReader,n=i(t);return t.readAsArrayBuffer(e),n}function l(e){var t=new FileReader,n=i(t);return t.readAsText(e),n}function u(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(v.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(v.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(v.arrayBuffer&&v.blob&&b(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return T.indexOf(t)>-1?t:e}function f(e,t){t=t||{};var n=t.body;if(e instanceof f){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function h(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var v={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(v.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,r){e=t(e),r=n(r);var o=this.map[e];this.map[e]=o?o+","+r:r},o.prototype.delete=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,r){this.map[t(e)]=n(r)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},v.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},d.call(f.prototype),d.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];y.redirect=function(e,t){if(E.indexOf(t)===-1)throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=f,e.Response=y,e.fetch=function(e,t){return new Promise(function(n,r){var o=new f(e,t),a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:h(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new y(t,e))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials&&(a.withCredentials=!0),"responseType"in a&&v.blob&&(a.responseType="blob"),o.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,t,n){e.exports=n(1)}])});