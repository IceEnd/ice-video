!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("isomorphic-fetch")):"function"==typeof define&&define.amd?define("ice-video",["react","isomorphic-fetch"],t):"object"==typeof exports?exports["ice-video"]=t(require("react"),require("isomorphic-fetch")):e["ice-video"]=t(e.React,e["isomorphic-fetch"])}(this,function(e,t){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(t,n){t.exports=e},function(e,t,n){"use strict";e.exports=n(2)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};n(15);var l=n(0),u=o(l),c=n(4),d=o(c),p=n(6),f=o(p),m=n(5),h=o(m),v=n(8),y=o(v),g=n(3),w=o(g),b=n(14),T=o(b),E=function(e){function t(n){r(this,t);var o=a(this,e.call(this,n));return o.getStyle=function(){var e={};if(o.props.width&&o.props.height)e.width=o.props.width,e.paddingTop=o.props.height;else switch(e.width="100%",o.props.scale){case"1:1":e.paddingTop="100%";break;case"4:3":e.paddingTop="75%";break;case"16:9":default:e.paddingTop="56.25%"}return e},o.getCurrentTime=function(e){o.setState({video:i(o.state.video,{currentTime:e})})},o.setCurrentTime=function(e){o.setState({playerAction:3,video:i(o.state.video,{currentTime:e})}),o.video.setCurrentTime(e),o.setState({playerAction:1})},o.setVolume=function(e){o.setState({video:i(o.state.video,{volume:e})}),o.video.setVolume(e)},o.setMuted=function(e){o.setState({video:i(o.state.video,{muted:e})}),o.video.setMuted(e)},o.setLoop=function(e){o.setState({video:i(o.state.video,{loop:e})}),o.video.setLoop(e)},o.setDanmukuConfig=function(e){o.setState({danmukuConfig:i(o.state.danmukuConfig,e)})},o.setPlayerConfig=function(e){o.setState({playerConfig:i(o.state.playerConfig,e)})},o.getBuffered=function(){o.setState({video:i(o.state.video,{bufferedTime:o.video.getBufferedEnd()})})},o.handleOnLoadStart=function(){0===o.state.video.playTimes?o.setState({playerStatus:0,startStatus:i(o.state.startStatus,{video:1})}):o.setState({video:i(o.state.video,{palyTimes:o.state.video.playTimes+1})})},o.handleOnLoadedMetadata=function(e){0===o.state.video.playTimes&&o.setState({video:i(o.state.video,{duration:e})})},o.handleOnLoadedData=function(){0===o.state.video.playTimes&&o.setState({startStatus:i(o.state.startStatus,{video:1})})},o.handleOnCanPaly=function(){0===o.state.video.playTimes&&(o.setState({startStatus:i(o.state.startStatus,{video:2,danmuku:1}),loading:!1}),o.fetchDanmuku()),o.setState({loading:!1})},o.handleOnError=function(e){o.setState({playerStatus:-1,startStatus:i({},o.state.playerTips,{video:3}),message:e})},o.handleOnWaiting=function(){o.setState({loading:!0})},o.handleOnEneded=function(){o.setState({playerStatus:3,playerAction:2})},o.handleControlSucess=function(){},o.handleOnPlay=function(e){var t=o.state.video;e?o.setState({video:i(t,{playTimes:1}),playerStatus:2,playerAction:1,controllerShow:!0,loading:!1}):o.setState({playerAction:1,loading:!1}),o.video.play(),o.startCurrentTimer()},o.handleOnPause=function(){o.setState({playerAction:2}),o.video.pause(),o.clearCurrentTimer()},o.handleOnMouseMove=function(){o.startControlsTimer()},o.fullScreenChange=function(){T.default.isFullscreen()?o.setState({fullScreen:!0}):(o.setState({fullScreen:!1}),o.danmuku.onWindowResize())},o.handleOnFullScreen=function(){T.default.isFullscreen()?T.default.exit():T.default.request(o.player)},o.fetchDanmuku=function(){fetch(o.props.getDanmukuUrl,{method:"POST",headers:{"Content-Type":"application/json"}}).then(function(e){return e.ok?e.json():Promise.reject({retCode:-1,retMsg:"弹幕加载失败"})}).then(function(e){0===e.retCode?o.setState({startStatus:i(o.state.startStatus,{danmuku:2,controller:1}),danmuku:e.retData.danmuku}):o.setState({startStatus:i(o.state.startStatus,{danmuku:3,controller:1})}),o.loadDanmuku()}).catch(function(e){console.error(e),o.setState({startStatus:i(o.state.startStatus,{danmuku:3,controller:1})}),o.loadDanmuku()})},o.sendDanmu=function(e){var t=i({},{content:e,date:new Date,timePoint:o.state.video.currentTime},i({},o.state.danmukuConfig));fetch(o.props.sendDanmukuUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.ok?e.json():Promise.reject({retCode:-1,retMsg:"弹幕发送失败"})}).then(function(e){0===e.retCode?o.danmuku.insertDanmuku(t):console.warn(e.retMsg)}).catch(function(e){console.warn(e)})},o.loadDanmuku=function(){setTimeout(function(){o.setState({startStatus:i(o.state.startStatus,{controller:2})})},500),setTimeout(function(){o.setState({playerStatus:2===o.state.startStatus.video?1:-1,showStart:!1})},1e3)},o.showControls=function(){clearTimeout(o.controlsHideTimer),o.setState({userActivity:!0})},o.hideControls=function(){o.startControlsTimer()},o.startControlsTimer=function(){o.setState({userActivity:!0,cursorShow:!0}),clearTimeout(o.controlsHideTimer),o.controlsHideTimer=setTimeout(function(){var e=!0;T.default.isFullscreen()&&(e=!1),o.setState({userActivity:!1,cursorShow:e})},3e3)},o.clearControlsTimer=function(){clearTimeout(o.controlsHideTimer),o.controlsHideTimer=null},o.startBufferedTimer=function(){o.bufferedTimer||(o.bufferedTimer=setInterval(function(){var e=o.video.getBuffered();o.setState({video:i(o.state.video,{bufferedTime:e})}),e>=o.state.video.duration&&o.clearBufferedTimer()},1e3))},o.clearBufferedTimer=function(){clearInterval(o.bufferedTimer),o.bufferedTimer=null},o.startCurrentTimer=function(){o.currentTimer||(o.currentTimer=setInterval(function(){o.setState({video:i(o.state.video,{currentTime:o.video.getCurrentTime()})})},250))},o.clearCurrentTimer=function(){clearInterval(o.currentTimer),o.currentTimer=null},o.renderStart=function(){var e=o.state,t=e.showStart,n=e.startStatus;return u.default.createElement(h.default,{showStart:t,startStatus:n})},o.renderPlay=function(){if(1!==o.state.playerStatus)return null;return u.default.createElement("button",{className:"play-button",onClick:function(){return o.handleOnPlay(!0)}},u.default.createElement("svg",{className:"play-svg",version:"1.1",fill:"white",dangerouslySetInnerHTML:{__html:'<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#play_icon" />'}}))},o.renderPalyer=function(e){var t={loop:o.props.loop,autoPlay:o.props.autoPlay,preload:o.props.preload,poster:o.props.poster,src:o.props.src},n={handleOnLoadStart:o.handleOnLoadStart,handleOnLoadedMetadata:o.handleOnLoadedMetadata,handleOnLoadedData:o.handleOnLoadedData,handleOnCanPaly:o.handleOnCanPaly,handleOnError:o.handleOnError,handleOnWaiting:o.handleOnWaiting,handleOnEneded:o.handleOnEneded},r={handleOnPause:o.handleOnPause,handleOnPlay:o.handleOnPlay,startControlsTimer:o.startControlsTimer,handleProcess:o.handleProcess,handleStopProcess:o.handleStopProcess,handleControlSucess:o.handleControlSucess,setCurrentTime:o.setCurrentTime,showControls:o.showControls,hideControls:o.hideControls,setVolume:o.setVolume,setMuted:o.setMuted,setLoop:o.setLoop,setDanmukuConfig:o.setDanmukuConfig,setPlayerConfig:o.setPlayerConfig,sendDanmu:o.sendDanmu,handleOnFullScreen:o.handleOnFullScreen},a=o.state.playerConfig.onOff,s=o.state.playerConfig.opacity,l=o.state,c=l.userActivity,d=l.cursorShow,p=l.fullScreen;return u.default.createElement("div",{className:"player-container video-react-container "+(p?"full-screen":"")+" "+(c?"player-user-activity":"player-user-inactivity")+" "+(d?"":"cursor-hide"),style:{paddingTop:e.paddingTop},ref:function(e){return o.player=e},onMouseMove:o.handleOnMouseMove},o.renderStart(),o.renderPlay(),u.default.createElement("div",{style:{display:-1===o.state.playerStatus?"block":"none"}},"Error"),u.default.createElement("svg",{className:"video-loading-svg",style:{display:o.state.loading?"block":"none"},version:"1.1",viewBox:"0 0 44 44",stroke:"#d09500",dangerouslySetInnerHTML:{__html:'<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_loading" />'}}),a&&u.default.createElement("div",{className:"canvas-container",style:{opacity:s}},u.default.createElement(w.default,{danmuku:o.state.danmuku,playerAction:o.state.playerAction,currentTime:o.state.video.currentTime,loading:o.state.loading,ref:function(e){return o.danmuku=e}})),u.default.createElement(f.default,i({key:"video"},t,n,{ref:function(e){return o.video=e}}),o.props.children),u.default.createElement(y.default,i({video:o.state.video,volume:o.state.volume,controls:o.props.controls,playerAction:o.state.playerAction,show:o.state.controllerShow,danmukuConfig:o.state.danmukuConfig,playerConfig:o.state.playerConfig,fullScreen:o.state.fullScreen},r)))},o.state={showStart:!0,startStatus:{video:0,danmuku:0,controller:0},playerStatus:0,playerAction:0,controllerShow:!1,userActivity:!0,cursorShow:!0,loading:!1,danmuku:[],fullScreen:!1,video:{playTimes:0,duration:0,currentTime:0,bufferedTime:0,volume:o.props.volume,muted:!1,loop:o.props.loop},danmukuConfig:{fontColor:"white",fontSize:"middle",model:"roll"},playerConfig:{opacity:1,scale:"normal",onOff:!0}},o}return s(t,e),t.prototype.componentDidMount=function(){this.video.setVolume(this.props.volume),T.default.addEventListener(this.fullScreenChange),this.startBufferedTimer()},t.prototype.componentWillUnmount=function(){this.clearBufferedTimer(),this.clearCurrentTimer(),this.clearControlsTimer()},t.prototype.render=function(){var e=this.getStyle();return u.default.createElement("div",{className:"ice-player-container"},u.default.createElement(d.default,null),this.renderPalyer(e))},t}(l.Component);E.displayName="IceVideo",E.propTypes={children:l.PropTypes.any,width:l.PropTypes.number,height:l.PropTypes.number,loop:l.PropTypes.bool,autoPlay:l.PropTypes.bool,preload:l.PropTypes.oneOf(["auto","metadata","none"]),volume:l.PropTypes.number,poster:l.PropTypes.string,getDanmukuUrl:l.PropTypes.string.isRequired,sendDanmukuUrl:l.PropTypes.string.isRequired,controls:l.PropTypes.bool,scale:l.PropTypes.string,src:l.PropTypes.string.isRequired},E.defaultProps={autoPlay:!1,preload:"auto",poster:"",loop:!1,volume:.8,controls:!0,scale:"16:9"},t.default=E},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(0),l=o(i),u=n(12),c=o(u),d=function(e){function t(){var n,o,s;r(this,t);for(var i=arguments.length,l=Array(i),u=0;u<i;u++)l[u]=arguments[u];return n=o=a(this,e.call.apply(e,[this].concat(l))),o.onWindowResize=function(){o.dc.resize(o.canvas)},o.insertDanmuku=function(e){o.dc.insertDanmuku(e)},s=n,a(o,s)}return s(t,e),t.prototype.componentDidMount=function(){this.dc=new c.default(this.canvas),this.dc.draw(),window.addEventListener("resize",this.onWindowResize)},t.prototype.shouldComponentUpdate=function(e){return e.currentTime!==this.props.currentTime||e.playerAction!==this.props.playerAction},t.prototype.componentDidUpdate=function(){var e=this.props,t=e.danmuku,n=e.playerAction,o=e.currentTime,r=e.loading;if(1!==n||r)(2===n||r)&&this.dc.stop();else{var a=t.filter(function(e){return e.timePoint>=o&&e.timePoint<o+.25});this.dc.addDanmuku(a),this.dc.draw()}},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onWindowResize)},t.prototype.render=function(){var e=this;return l.default.createElement("canvas",{className:"player-danmuku",ref:function(t){return e.canvas=t}})},t}(i.Component);d.displayName="IcePlayerDanmuku",d.propTypes={danmuku:i.PropTypes.arrayOf(i.PropTypes.shape({content:i.PropTypes.string,date:i.PropTypes.string,timePoint:i.PropTypes.number})),playerAction:i.PropTypes.number,currentTime:i.PropTypes.number,loading:i.PropTypes.bool},t.default=d},function(e,t,n){"use strict";t.__esModule=!0;var o=n(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(){return r.default.createElement("svg",{display:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("symbol",{id:"video_play",viewBox:"0 0 36 36"},r.default.createElement("path",{d:"M25.8 18c0 .6-.3 1.1-.8 1.3L12.5 27c-.2.1-.5.2-.8.2-.8 0-1.5-.6-1.5-1.5V10c0-.8.7-1.5 1.5-1.5.3 0 .5.1.8.2l12.7 7.9c.4.5.6.9.6 1.4z"})),r.default.createElement("symbol",{id:"video_pause",viewBox:"0 0 36 36"},r.default.createElement("path",{d:"M23.5 28c-.8 0-1.5-.7-1.5-1.5v-17c0-.8.7-1.5 1.5-1.5s1.5.7 1.5 1.5v17c0 .8-.7 1.5-1.5 1.5zm-11 0c-.8 0-1.5-.7-1.5-1.5v-17c0-.8.7-1.5 1.5-1.5s1.5.7 1.5 1.5v17c0 .8-.7 1.5-1.5 1.5z"})),r.default.createElement("symbol",{id:"video_setting",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M21 11v2l-2 1v-.3c-.2.7-.5 1.5-.9 2.1l.2-.2.7 2.1-1.4 1.4-2.1-.7.2-.2c-.7.4-1.4.7-2.1.9h.4l-1 2h-2l-1-2h.3c-.7-.2-1.5-.5-2.1-.9l.2.2-2.1.7-1.4-1.4.7-2.1.2.2c-.4-.7-.7-1.4-.9-2.1v.3l-2-1v-2l2-1v.4c.2-.8.5-1.6 1-2.3l-.3.4-.7-2.2 1.4-1.4 2.1.7-.3.4c.7-.5 1.5-.8 2.3-1H10l1-2h2l1 2h-.4c.8.2 1.6.5 2.3.9l-.3-.3 2.1-.7 1.4 1.4-.7 2.1-.3-.3c.4.7.7 1.4.9 2.2V10l2 1zm-9-4c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5z"})),r.default.createElement("symbol",{id:"video_volume",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M22 12c0 2.2-.8 4.1-2 5.7v.2c0 .5-.4.9-.9 1l-1.3-1.8C19.1 15.8 20 14 20 12c0-2-.8-3.8-2.2-5-.3-.2-.5-.5-.5-.9 0-.6.4-1 1-1 .3 0 .5.1.7.3 1.9 1.6 3 4 3 6.6zm-5.3 3.3c-.1.1-.1.2-.2.2-.2.1-.3.2-.6.2-.6 0-1-.4-1-1 0-.3.2-.6.4-.8.4-.5.6-1.1.6-1.8s-.2-1.3-.6-1.8l.1-.1c-.2-.3-.4-.6-.4-.9 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1.4-.5 2.5-1.3 3.4zM13 3zm-.3 17.7c-.2.2-.4.3-.7.3-.3 0-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h2.8l5.4-3.6c.2-.3.5-.4.8-.4.2 0 .5.1.7.3.2.2.3.4.3.7v16c0 .3-.1.5-.3.7zM11 5.8L6.8 8.6c-.2.3-.5.4-.8.4H4v6h2c.3 0 .6.1.8.4l4.2 2.9V5.8z"})),r.default.createElement("symbol",{id:"video_volume_damping",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M16.7 15.3c-.1.1-.1.2-.2.2-.2.1-.3.2-.6.2-.6 0-1-.4-1-1 0-.3.2-.6.4-.8.4-.5.6-1.1.6-1.8s-.2-1.3-.6-1.8l.1-.1c-.2-.3-.4-.6-.4-.9 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1.4-.5 2.5-1.3 3.4zm-4 5.4c-.2.2-.4.3-.7.3s-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h2.8l5.4-3.6c.2-.3.5-.4.8-.4.2 0 .5.1.7.3s.3.4.3.7v16c0 .3-.1.5-.3.7zM11 5.8L6.8 8.6c-.2.3-.5.4-.8.4H4v6h2c.3 0 .6.1.8.4l4.2 2.9V5.8z"})),r.default.createElement("symbol",{id:"video_volume_mute",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M20.2 17.4L18.8 16c.8-1.1 1.2-2.5 1.2-3.9 0-2-.8-3.8-2.2-5-.3-.2-.5-.5-.5-.9 0-.6.4-1 1-1 .3 0 .5.1.7.3 1.8 1.6 3 4 3 6.7 0 1.8-.7 3.7-1.8 5.2zm-2.9-2.9L15.8 13c.1-.3.2-.6.2-1 0-.7-.2-1.3-.6-1.8l.1-.1c-.3-.2-.5-.5-.5-.8 0-.6.4-1 1-1 .4 0 .8.3.9.6.7.8 1.1 1.9 1.1 3 0 1-.3 1.9-.7 2.6zM13 3zm-2 2.8l-1.4 1-1.4-1.4 3-2c.2-.3.5-.4.8-.4.2 0 .5.1.7.3.2.2.3.4.3.7v6.2l-2-2V5.8zm9.7 14.9c-.4.4-1 .4-1.4 0l-16-16c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l16 16c.4.4.4 1 0 1.4zM4.2 7l2 2H4v6h2c.3 0 .6.1.8.4l4.2 2.8v-4.4l2 2V20c0 .2-.1.5-.3.7-.2.2-.4.3-.7.3-.3 0-.6-.1-.8-.4L5.8 17H3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1h1.2z"})),r.default.createElement("symbol",{id:"video_fullscreen",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M19.7 19.7c-.2.2-.5.3-.7.3h-4c-.6 0-1-.4-1-1s.4-1 1-1h1.6l-3.3-3.3c-.4-.4-.3-1.1.1-1.4.4-.4 1-.4 1.4 0l3.3 3.3V15c0-.6.4-1 1-1s1 .4 1 1v4c-.1.2-.2.5-.4.7zM19 10c-.6 0-1-.4-1-1V7.4l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L16.6 6H15c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .6-.4 1-1 1zM7.4 18H9c.6 0 1 .4 1 1s-.4 1-1 1H5c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7v-4c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L7.4 18zm1.9-7.3L6 7.4V9c0 .6-.4 1-1 1s-1-.4-1-1V5c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3h4c.6 0 1 .4 1 1s-.4 1-1 1H7.4l3.3 3.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0z"})),r.default.createElement("symbol",{id:"video_fullscreen_true",viewBox:"0 0 24 24"},r.default.createElement("path",{d:"M16.4 9H18c.6 0 1 .4 1 1s-.4 1-1 1h-4c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7V6c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L16.4 9zM10 19c-.6 0-1-.4-1-1v-1.6l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L7.6 15H6c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .5-.4 1-1 1zm0-8H6c-.6 0-1-.4-1-1s.4-1 1-1h1.6L4.3 5.7c-.4-.4-.4-1 .1-1.4.4-.4 1-.4 1.4 0L9 7.6V6c0-.6.4-1 1-1s1 .4 1 1v4c0 .3-.1.5-.3.7-.2.2-.5.3-.7.3zm4 2h4c.6 0 1 .4 1 1s-.4 1-1 1h-1.6l3.3 3.3c.4.4.4 1 0 1.4s-1 .4-1.4 0L15 16.4V18c0 .6-.4 1-1 1s-1-.4-1-1v-4c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3z"})),r.default.createElement("symbol",{id:"play_icon",viewBox:"0 0 100 100"},r.default.createElement("path",{d:"M 18.56 10.20 Q 12.5,6.599 12.5,13.70 L 12.5 86.30 Q 12.5,94.301 18.56,89.80 L 81.44 53.50 Q 87.5,50 81.44,46.50 Z",transform:"scale(1)",fill:"white"})),r.default.createElement("symbol",{id:"video_repeat_true",viewBox:"0 0 36 36"},r.default.createElement("path",{d:"M5.5 10.5L0.1 15.5L3.5 15.5L3.5 18.5Q3.5 30.5, 13.5 30.5L26 30.5L24.5 29Q23 27.5, 21.5 27.5L17 27.5Q7.5 27.5, 7.5 18L7.5 15.5L10.9 15.5 Z"}),r.default.createElement("path",{d:"M30.5 25.5L35.9 20.5L32.5 20.5L32.5 15.5Q32.5 5.5, 22 5.5L10 5.5L11.5 7Q13 8.5, 14.5 8.5L19 8.5Q28.5 8.5, 28.5 18L28.5 20.5L25.1 20.5 Z"})),r.default.createElement("symbol",{id:"video_repeat_false",viewBox:"0 0 36 36"},r.default.createElement("path",{d:"M5.5 10.5L0.1 15.5L3.5 15.5L3.5 18.5Q3.5 30.5, 13.5 30.5L26 30.5L24.5 29Q23 27.5, 21.5 27.5L17 27.5Q7.5 27.5, 7.5 18L7.5 15.5L10.9 15.5 Z"}),r.default.createElement("path",{d:"M30.5 25.5L35.9 20.5L32.5 20.5L32.5 15.5Q32.5 5.5, 22 5.5L10 5.5L11.5 7Q13 8.5, 14.5 8.5L19 8.5Q28.5 8.5, 28.5 18L28.5 20.5L25.1 20.5 Z"}),r.default.createElement("path",{d:"M5.5 7.7L30.5 31.2L30.5 28.3L5.5 4.2Z"})),r.default.createElement("symbol",{id:"danmuku-roll",viewBox:"0 0 48 48"},r.default.createElement("rect",{x:"12",y:"20",width:"18",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"32",y:"20",width:"3",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"3",y:"24",width:"20",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"25",y:"24",width:"13",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"40",y:"24",width:"4",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"10",y:"28",width:"14",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"26",y:"28",width:"6",height:"2",style:{fill:"white"}})),r.default.createElement("symbol",{id:"danmuku-top",viewBox:"0 0 48 48"},r.default.createElement("rect",{x:"10",y:"8",width:"28",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"18",y:"12",width:"12",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"16",y:"16",width:"16",height:"2",style:{fill:"white"}})),r.default.createElement("symbol",{id:"danmuku-bottom",viewBox:"0 0 48 48"},r.default.createElement("rect",{x:"10",y:"40",width:"28",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"18",y:"36",width:"12",height:"2",style:{fill:"white"}}),r.default.createElement("rect",{x:"16",y:"32",width:"16",height:"2",style:{fill:"white"}})),r.default.createElement("symbol",{id:"video_loading",viewBox:"0 0 44 44"},r.default.createElement("g",{fill:"none",fillRule:"evenodd",strokeWidth:"2"},r.default.createElement("circle",{cx:"22",cy:"22",r:"1"},r.default.createElement("animate",{attributeName:"r",begin:"0s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"stroke-opacity",begin:"0s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})),r.default.createElement("circle",{cx:"22",cy:"22",r:"1"},r.default.createElement("animate",{attributeName:"r",begin:"-0.9s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"stroke-opacity",begin:"-0.9s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})))),r.default.createElement("symbol",{id:"loading_start",viewBox:"0 0 135 140",width:"135",height:"140"},r.default.createElement("rect",{y:"10",width:"15",height:"120",rx:"6"},r.default.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("rect",{x:"30",y:"10",width:"15",height:"120",rx:"6"},r.default.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("rect",{x:"60",width:"15",height:"140",rx:"6"},r.default.createElement("animate",{attributeName:"height",begin:"0s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"y",begin:"0s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("rect",{x:"90",y:"10",width:"15",height:"120",rx:"6"},r.default.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("rect",{x:"120",y:"10",width:"15",height:"120",rx:"6"},r.default.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"}))))};a.displayName="IcePlayerSVG",t.default=a},function(e,t,n){"use strict";t.__esModule=!0;var o=n(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(e){var t=e.video,n=e.danmuku,o=e.controller,a=["","","[完成]","[失败]"];return r.default.createElement("div",{className:"loading-tips-container"},r.default.createElement("ul",null,r.default.createElement("li",{style:{visibility:0===t?"hidden":"visible"}},"视屏核动力注入...",r.default.createElement("i",null,a[t])),r.default.createElement("li",{style:{visibility:0===n?"hidden":"visible"}},"主武器弹幕装填...",r.default.createElement("i",null,a[n])),r.default.createElement("li",{style:{visibility:0===o?"hidden":"visible"}},"驾驶舱神经同步...",r.default.createElement("i",null,a[o])),r.default.createElement("li",{style:{visibility:0===o||1===o?"hidden":"visible"}},3===t?"初号机启动失败.":"初号机就绪.")))},s=function(e){var t=e.startStatus,n=e.showStart;return r.default.createElement("div",{className:"player-loading",style:{display:n?"block":"none"}},r.default.createElement("svg",{className:"loading-icon",version:"1.1",fill:"white",dangerouslySetInnerHTML:{__html:'<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#loading_start" />'}}),a(t))};s.displayName="IceVideoStart",s.propTypes={showStart:o.PropTypes.bool.isRequired,startStatus:o.PropTypes.shape({video:o.PropTypes.oneOf([0,1,2,3]),barrage:o.PropTypes.oneOf([0,1,2,3]),controller:o.PropTypes.oneOf([0,1,2,3])})},t.default=s},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(n){o(this,t);var a=r(this,e.call(this,n));return a.onLoadStart=function(){a.props.handleOnLoadStart()},a.onLoadedMetaData=function(){var e=a.video.duration;a.props.handleOnLoadedMetadata(e)},a.onLoadedData=function(){a.props.handleOnLoadedData()},a.onWaiting=function(){a.props.handleOnWaiting()},a.onCanPlay=function(){a.props.handleOnCanPaly()},a.onError=function(){var e=a.video.error;a.props.handleOnError(e)},a.getBuffered=function(){var e=a.video.buffered,t=0;try{t=e.end(0)||0,t=parseInt(1e3*t+1,10)/1e3}catch(e){}return t},a.getCurrentTime=function(){return a.video.currentTime},a.setCurrentTime=function(e){a.video.currentTime=e},a.setLoop=function(e){a.video.loop=e},a.setMuted=function(e){a.video.muted=e},a.setVolume=function(e){a.video.volume=e},a.play=function(){a.video.play()},a.pause=function(){a.video.pause()},a.video=null,a}return a(t,e),t.prototype.shouldComponentUpdate=function(e){return e.src!==this.props.src},t.prototype.render=function(){var e=this;return i.default.createElement("video",{className:"react-video",src:this.props.src,loop:this.props.loop,autoPlay:this.props.autoPlay,preload:this.props.preload,poster:this.props.poster,ref:function(t){return e.video=t},onCanPlay:this.onCanPlay,onError:this.onError,onLoadStart:this.onLoadStart,onLoadedMetadata:this.onLoadedMetaData,onLoadedData:this.onLoadedData,onWaiting:this.onWaiting,onProgress:this.onProgress,onPlay:this.onPlay,onEnded:this.handleOnEnded})},t}(s.Component);l.displayName="IcePlayerVideo",l.propTypes={src:s.PropTypes.string,loop:s.PropTypes.bool,autoPlay:s.PropTypes.bool,preload:s.PropTypes.string,poster:s.PropTypes.string,handleOnLoadStart:s.PropTypes.func.isRequired,handleOnLoadedMetadata:s.PropTypes.func.isRequired,handleOnLoadedData:s.PropTypes.func.isRequired,handleOnCanPaly:s.PropTypes.func.isRequired,handleOnWaiting:s.PropTypes.func.isRequired,handleOnError:s.PropTypes.func.isRequired},l.defaultProps={autoPlay:!1,preload:"auto",loop:!1,volume:.8,controls:!0},t.default=l},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(s),l=["white","black","ghostwhite","snow","whitesmoke","silver","darkgray","grey","dimgray","lavender","skyblue","royalblue","mediumblue","purple","blue","steelblue","darkblue","navy","blueviolet","lightpink","pink","hotpink","peachpuff","deeppink","mediumvioletred","red","crimson","firebrick","darkred","aquamarine","mediumaquamarine","cyan","springgreen","lightgreen","seagreen","forestgreen","limegreen","green","darkgreen","ivory","wheat","lemonchiffon","khaki","bisque","lightgoldenrodyellow","Yellow","gold","goldenrod","orange","tan","lightcoral","peru","olivedrab","chocolate","sienna","brown","saddlebrown","maroon"],u=function(e){function t(n){o(this,t);var a=r(this,e.call(this,n));return a.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=a.getLeft(e.offsetParent)),t},a.setMenu=function(e){return function(){a.setState({menu:e})}},a.setOpacity=function(e){e.preventDefault(),a.state.dragOpacity&&a.setState({dragOpacity:!1})},a.setOnOff=function(e){return function(){a.props.setPlayerConfig(e)}},a.hanldeOnDanmuku=function(e){return function(){a.props.setDanmukuConfig(e)}},a.handleOnIndicatorMouseDown=function(e){e.preventDefault();var t=a.opacityBar.offsetWidth,n=a.getLeft(a.opacityBar);a.setState({dragOpacity:!0,dragOpacityWidth:a.computeLeftX(e.clientX,n,t)/t})},a.handleOnOpacityMouseMove=function(e){if(e.preventDefault(),a.state.dragOpacity){var t=a.opacityBar.offsetWidth,n=a.getLeft(a.opacityBar),o=a.computeLeftX(e.clientX,n,t)/t;a.setState({dragOpacityWidth:o}),a.props.setPlayerConfig({opacity:o})}},a.handleOnOpacityBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=a.opacityBar.offsetWidth,n=a.getLeft(a.opacityBar);a.props.setPlayerConfig({opacity:a.computeLeftX(e.clientX,n,t)/t})},a.computeLeftX=function(e,t,n){return e<t?0:e>t+n?n:e-t},a.state={menu:"danmuku",dragOpacity:!1,dragOpacityWidth:0},a}return a(t,e),t.prototype.shouldComponentUpdate=function(e,t){return e!==this.props||t!==this.state},t.prototype.render=function(){var e=this,t=this.state,n=t.menu,o=t.dragOpacity,r=t.dragOpacityWidth,a=this.props.danmukuConfig,s=a.model,u=a.fontSize,c=a.fontColor,d=this.props.playerConfig,p=d.opacity,f=d.onOff;return i.default.createElement("div",{className:"video-config-container"},i.default.createElement("div",{className:"video-config","data-status":n},i.default.createElement("div",{className:"video-config-bar"},i.default.createElement("ul",null,i.default.createElement("li",{className:"danmuku-li",onClick:this.setMenu("danmuku")},"弹幕设置"),i.default.createElement("li",{className:"player-li",onClick:this.setMenu("player")},"播放器设置"))),i.default.createElement("div",{className:"video-config-content"},i.default.createElement("div",{className:"config-group danmuku-group"},i.default.createElement("div",{className:"config-item danmuku-font","data-status":u},i.default.createElement("span",{className:"row-title"},"字号"),i.default.createElement("div",{className:"row-selection"},i.default.createElement("span",{className:"selection-name small",onClick:this.hanldeOnDanmuku({fontSize:"small"})},"小"),i.default.createElement("span",{className:"selection-name middle",onClick:this.hanldeOnDanmuku({fontSize:"middle"})},"中"),i.default.createElement("span",{className:"selection-name large",onClick:this.hanldeOnDanmuku({fontSize:"large"})},"大"))),i.default.createElement("div",{className:"config-item danmuku-model","data-status":s},i.default.createElement("span",{className:"row-title"},"模式"),i.default.createElement("div",{className:"row-selection"},i.default.createElement("div",{className:"selection-span model-roll",onClick:this.hanldeOnDanmuku({model:"roll"})},i.default.createElement("svg",{className:"model-svg model-roll-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:'<use class="model-roll-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-roll" />'}}),i.default.createElement("span",{className:"selection-name roll"},"滚动")),i.default.createElement("div",{className:"selection-span model-top",onClick:this.hanldeOnDanmuku({model:"top"})},i.default.createElement("svg",{className:"model-svg model-top-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:'<use class="model-top-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-top" />'}}),i.default.createElement("span",{className:"selection-name top"},"顶部")),i.default.createElement("div",{className:"selection-span model-bottom",onClick:this.hanldeOnDanmuku({model:"bottom"})},i.default.createElement("svg",{className:"model-svg model-bottom-svg",version:"1.1",viewBox:"0 0 48 48",dangerouslySetInnerHTML:{__html:'<use class="model-bottom-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#danmuku-bottom" />'}}),i.default.createElement("span",{className:"selection-name bottom"},"底部")))),i.default.createElement("div",{className:"config-item danmuku-color","data-status":c},i.default.createElement("span",{className:"row-title"},"颜色"),i.default.createElement("div",{className:"row-selection"},l.map(function(t){return i.default.createElement("span",{className:"color-item "+(c===t?"active":""),key:t,style:{backgroundColor:t},onClick:e.hanldeOnDanmuku({fontColor:t})})})))),i.default.createElement("div",{className:"config-group player-group"},i.default.createElement("div",{className:"config-item danmuku-opacity"},i.default.createElement("span",{className:"row-title"},"透明"),i.default.createElement("div",{className:"row-selection",onMouseMove:this.handleOnOpacityMouseMove,onMouseLeave:this.setOpacity,onMouseUp:this.setOpacity},i.default.createElement("div",{className:"opacity-bar",ref:function(t){return e.opacityBar=t},onClick:this.handleOnOpacityBarClick},i.default.createElement("div",{className:"opacity-bar-level",style:{width:(o?100*r:100*p)+"%"}},i.default.createElement("button",{className:"opacity-bar-indicator",onMouseDown:this.handleOnIndicatorMouseDown,onMouseUp:this.setOpacity}))))),i.default.createElement("div",{className:"config-item player-on-off","data-status":f?"on":"off"},i.default.createElement("span",{className:"row-title"},"弹幕"),i.default.createElement("div",{className:"row-selection"},i.default.createElement("span",{className:"selection-name on",onClick:this.setOnOff({onOff:!0})},"开"),i.default.createElement("span",{className:"selection-name off",onClick:this.setOnOff({onOff:!1})},"关"))),i.default.createElement("div",{className:"config-item player-size","data-status":"normal"},i.default.createElement("span",{className:"row-title"},"比例"),i.default.createElement("div",{className:"row-selection"},i.default.createElement("span",{className:"selection-name normal"},"16:9")))))))},t}(s.Component);u.displayName="IcePlayerControllerConfig",u.propTypes={danmukuConfig:s.PropTypes.shape({fontColor:s.PropTypes.string,fontSize:s.PropTypes.oneOf(["small","middle","large"]),model:s.PropTypes.oneOf(["roll","top","bottom"])}),playerConfig:s.PropTypes.shape({opacity:s.PropTypes.number,scale:s.PropTypes.string,onOff:s.PropTypes.bool}),setDanmukuConfig:s.PropTypes.func.isRequired,setPlayerConfig:s.PropTypes.func.isRequired},t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(0),l=o(i),u=n(10),c=o(u),d=n(9),p=o(d),f=n(11),m=o(f),h=n(7),v=o(h),y=function(e){function t(n){r(this,t);var o=a(this,e.call(this,n));return o.handleOnPlayIcon=function(){var e=o.props,t=e.playerAction;(0,e.startControlsTimer)(),1===t?o.props.handleOnPause():o.props.handleOnPlay(!1)},o.handleOnRepeatClick=function(e){e.preventDefault();var t=void 0;t=!o.props.video.loop,o.props.setLoop(t)},o.handleOnSetting=function(){var e=o.state.showConfig,t=!1;e||(t=!0),o.setState({showConfig:t})},o.handleOnFullScreenClick=function(){o.props.handleOnFullScreen()},o.computeLeftX=function(e,t,n){return e<t?0:e>t+n?n:e-t},o.state={showConfig:!1},o}return s(t,e),t.prototype.shouldComponentUpdate=function(e,t){return e!==this.props||t!==this.state},t.prototype.render=function(){var e=this.props,t=e.controls,n=e.playerAction,o=e.show,r=e.video;if(!t)return null;var a="";1===n||3===n?a="pause":2===n&&(a="play");var s=this.state.showConfig?"show":"hide",i=this.props.fullScreen;return l.default.createElement("div",{className:"video-control-main "+(o?"":"video-control-main-hidden")},l.default.createElement(c.default,{currentTime:this.props.video.currentTime,bufferedTime:this.props.video.bufferedTime,duration:this.props.video.duration,setCurrentTime:this.props.setCurrentTime}),l.default.createElement("div",{className:"video-control-bar"},l.default.createElement("button",{className:"video-control-item video-btn-play","data-status":a,"aria-label":"播放/暂停",onClick:this.handleOnPlayIcon},l.default.createElement("svg",{className:"video-svg",version:"1.1",dangerouslySetInnerHTML:{__html:'<use class="video-svg-play video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_play" /><use class="video-svg-pause video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_pause" />'}})),l.default.createElement(p.default,{showControls:this.props.showControls,hideControls:this.props.hideControls,sendDanmu:this.props.sendDanmu}),l.default.createElement("div",{className:"video-control-bar-right","data-config":s},l.default.createElement(m.default,{video:this.props.video,volume:this.props.video.volume,muted:this.props.video.muted,setVolume:this.props.setVolume,setMuted:this.props.setMuted}),l.default.createElement("button",{className:"video-control-item video-btn-setting","aria-label":"设置","data-config":s,onClick:this.handleOnSetting},l.default.createElement("svg",{className:"video-svg",version:"1.1",dangerouslySetInnerHTML:{__html:'<use class="" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_setting" />'}})),l.default.createElement("button",{className:"video-control-item video-btn-repeat","aria-label":"循环","data-status":r.loop,"data-msg":r.loop?"关闭循环":"洗脑循环",onClick:this.handleOnRepeatClick},l.default.createElement("svg",{className:"video-svg",version:"1.1",dangerouslySetInnerHTML:{__html:'<use class="video-svg-repeat-true video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_repeat_true" /><use class="video-svg-repeat-false video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_repeat_false" />'}})),l.default.createElement("button",{className:"video-control-item video-btn-fullscreen","aria-label":"全屏","data-status":i,onClick:this.handleOnFullScreenClick},l.default.createElement("svg",{className:"video-svg",version:"1.1",dangerouslySetInnerHTML:{__html:'<use class="video-svg-fullscreen video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_fullscreen" /><use class="video-svg-fullscreen-true video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_fullscreen_true" />'}})),l.default.createElement(v.default,{danmukuConfig:this.props.danmukuConfig,playerConfig:this.props.playerConfig,setDanmukuConfig:this.props.setDanmukuConfig,setPlayerConfig:this.props.setPlayerConfig}))))},t}(i.Component);y.displayName="IcePlayerController",y.propTypes={controls:i.PropTypes.bool.isRequired,playerAction:i.PropTypes.number.isRequired,show:i.PropTypes.bool.isRequired,video:i.PropTypes.shape({playTimes:i.PropTypes.number.isRequired,duration:i.PropTypes.number.isRequired,currentTime:i.PropTypes.number.isRequired,bufferedTime:i.PropTypes.number.isRequired,volume:i.PropTypes.number.isRequired,muted:i.PropTypes.bool.isRequired,loop:i.PropTypes.bool.isRequired}),fullScreen:i.PropTypes.bool,danmukuConfig:i.PropTypes.shape({fontColor:i.PropTypes.string,fontSize:i.PropTypes.oneOf(["small","middle","large"]),model:i.PropTypes.oneOf(["roll","top","bottom"])}),playerConfig:i.PropTypes.shape({opacity:i.PropTypes.number,scale:i.PropTypes.string,onOff:i.PropTypes.bool}),handleOnPause:i.PropTypes.func.isRequired,handleOnPlay:i.PropTypes.func.isRequired,startControlsTimer:i.PropTypes.func.isRequired,setCurrentTime:i.PropTypes.func.isRequired,showControls:i.PropTypes.func.isRequired,hideControls:i.PropTypes.func.isRequired,setVolume:i.PropTypes.func.isRequired,setMuted:i.PropTypes.func.isRequired,setLoop:i.PropTypes.func.isRequired,setDanmukuConfig:i.PropTypes.func.isRequired,setPlayerConfig:i.PropTypes.func.isRequired,sendDanmu:i.PropTypes.func.isRequired,handleOnFullScreen:i.PropTypes.func.isRequired},t.default=y},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(){var n,a,s;o(this,t);for(var i=arguments.length,l=Array(i),u=0;u<i;u++)l[u]=arguments[u];return n=a=r(this,e.call.apply(e,[this].concat(l))),a.handleOnInputFocus=function(){a.props.showControls()},a.handleOnInputBlur=function(){a.props.hideControls()},a.handleOnInputKeyUp=function(e){a.props.showControls(),13===e.keyCode&&(a.props.sendDanmu(a.input.value),a.input.value="")},s=n,r(a,s)}return a(t,e),t.prototype.shouldComponentUpdate=function(){return!1},t.prototype.render=function(){var e=this;return i.default.createElement("div",{className:"video-control-item video-control-input"},i.default.createElement("input",{className:"video-danmuku-input",type:"text",placeholder:"发个弹幕吐槽吧...",ref:function(t){return e.input=t},onFocus:this.handleOnInputFocus,onBlur:this.handleOnInputBlur,onKeyUp:this.handleOnInputKeyUp}))},t}(s.Component);l.displayName="IcePlayerControllerDanmukuInput",l.propTypes={showControls:s.PropTypes.func.isRequired,hideControls:s.PropTypes.func.isRequired,sendDanmu:s.PropTypes.func.isRequired},t.default=l},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(0),l=o(i),u=n(13),c=o(u),d=function(e){function t(n){r(this,t);var o=a(this,e.call(this,n));return o.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=o.getLeft(e.offsetParent)),t},o.processMouseMove=function(e){e.preventDefault();var t=o.processBar.offsetWidth,n=o.getLeft(o.processBar),r=o.computeLeftX(e.clientX,n,t);o.setState({processMouseLeft:r,processMouseDispaly:!0}),o.state.dragProgress&&o.setState({dragProgressWidth:r/t*100}),o.hideProcessMouse()},o.processMouseUp=function(e){if(e.preventDefault(),o.state.dragProgress){var t=o.state.dragProgressWidth/100*o.props.duration;o.props.setCurrentTime(t),o.setState({dragProgress:!1})}},o.processMouseLeave=function(){if(clearTimeout(o.hideProcessMouseTimer),o.setState({processMouseDispaly:!1,dragProgress:!1}),o.state.dragProgress){var e=o.state.dragProgressWidth/100*o.props.duration;o.props.setCurrentTime(e),o.setState({dragProgress:!1})}},o.processScrubberMoveDown=function(e){e.preventDefault();var t=o.processBar.offsetWidth,n=o.getLeft(o.processBar);o.setState({dragProgress:!0,dragProgressWidth:o.computeLeftX(e.clientX,n,t)/t*100})},o.processBarMouseDown=function(e){e.preventDefault(),e.stopPropagation()},o.processBarMouseUp=function(e){e.preventDefault(),e.stopPropagation()},o.processBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=o.processBar.offsetWidth,n=o.getLeft(o.processBar),r=o.computeLeftX(e.clientX,n,t)/t*o.props.duration;o.props.setCurrentTime(r)},o.hideProcessMouse=function(){clearTimeout(o.hideProcessMouseTimer),o.hideProcessMouseTimer=setTimeout(function(){o.setState({processMouseDispaly:!1})},1500)},o.computeLeftX=function(e,t,n){return e<t?0:e>t+n?n:e-t},o.state={processMouseLeft:0,processMouseDispaly:!1,dragProgress:!1,dragProgressWidth:0,dragVolume:!1,dragVolumeWidth:0},o}return s(t,e),t.prototype.shouldComponentUpdate=function(e,t){var n=e.duration,o=e.currentTime,r=e.bufferedTime;return n!==this.props.duration||o!==this.props.currentTime||r!==this.props.bufferedTime||t!==this.state},t.prototype.componentWillUnmount=function(){clearTimeout(this.hideProcessMouseTimer)},t.prototype.render=function(){var e=this,t=this.props,n=t.currentTime,o=t.bufferedTime,r=t.duration,a=this.state,s=a.processMouseLeft,i=a.processMouseDispaly,u=a.dragProgress,d=a.dragProgressWidth;return l.default.createElement("div",{className:"video-progress","aria-label":"进度轴"},l.default.createElement("div",{className:"video-time-display"},l.default.createElement("span",{className:"video-time"},(0,c.default)(n))),l.default.createElement("div",{className:"video-progress-bar","aria-label":"进度条",ref:function(t){return e.processBar=t},onMouseMove:this.processMouseMove,onMouseLeave:this.processMouseLeave,onMouseUp:this.processMouseUp},l.default.createElement("span",{className:"video-process-list",onClick:this.processBarClick,onMouseDown:this.processBarMouseDown,onMouseUp:this.processBarMouseUp},l.default.createElement("div",{className:"video-process-load",style:{width:o/r*100+"%"}}),l.default.createElement("span",{className:"video-process-mouse-display "+(i?"video-process-mouse-display-show":""),"data-time":""+(i?(0,c.default)(s/this.processBar.offsetWidth*r):0),style:{left:s+"px"}}),l.default.createElement("div",{className:"video-process-play",style:{width:(u?d:n/r*100)+"%"}},l.default.createElement("button",{className:"video-process-scrubber-indicator",onMouseDown:this.processScrubberMoveDown,onMouseUp:this.processMouseUp})))),l.default.createElement("div",{className:"video-time-display"},l.default.createElement("span",{className:"video-time"},(0,c.default)(r))))},t}(i.Component);d.displayName="IcePlayerControllerProcess",d.propTypes={duration:i.PropTypes.number.isRequired,currentTime:i.PropTypes.number.isRequired,bufferedTime:i.PropTypes.number.isRequired,setCurrentTime:i.PropTypes.func.isRequired},t.default=d},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(n){o(this,t);var a=r(this,e.call(this,n));return a.getLeft=function(e){var t=e.offsetLeft;return null!==e.offsetParent&&(t+=a.getLeft(e.offsetParent)),t},a.setVolume=function(e){e.preventDefault(),a.state.dragVolume&&a.setState({dragVolume:!1})},a.handleOnVolumeIndicatorMouseDown=function(e){e.preventDefault();var t=a.volumeBar.offsetWidth,n=a.getLeft(a.volumeBar),o=a.computeLeftX(e.clientX,n,t)/t;a.setState({dragVolume:!0,dragVolumeWidth:o})},a.handleOnVolumeMouseMove=function(e){if(e.preventDefault(),a.state.dragVolume){var t=a.volumeBar.offsetWidth,n=a.getLeft(a.volumeBar),o=a.computeLeftX(e.clientX,n,t)/t;a.setState({dragVolumeWidth:o}),a.props.setVolume(o)}},a.handleOnVolumeBarClick=function(e){e.preventDefault(),e.stopPropagation();var t=a.volumeBar.offsetWidth,n=a.getLeft(a.volumeBar);a.props.setVolume(a.computeLeftX(e.clientX,n,t)/t)},a.handleOnVolumeIconClick=function(e){e.preventDefault();var t=void 0;t=!a.props.muted,a.props.setMuted(t)},a.computeLeftX=function(e,t,n){return e<t?0:e>t+n?n:e-t},a.state={dragVolume:!1,dragVolumeWidth:0},a}return a(t,e),t.prototype.shouldComponentUpdate=function(e){var t=e.volume,n=e.muted;return t!==this.props.volume||n!==this.props.muted},t.prototype.render=function(){var e=this,t=this.props,n=t.volume,o=t.muted,r=this.state,a=r.dragVolume,s=r.dragVolumeWidth,l="";return l=n>=.5?"normal":n<.5&&n>0?"damping":"mute",o&&(l="mute"),i.default.createElement("div",{className:"video-control-item video-btn-volume","aria-label":"音量","data-status":l,onMouseMove:this.handleOnVolumeMouseMove,onMouseLeave:this.setVolume,onMouseUp:this.setVolume},i.default.createElement("svg",{className:"video-svg",version:"1.1",viewBox:"0 0 24 24",dangerouslySetInnerHTML:{__html:'<use class="video-svg-volume video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume" /><use class="video-svg-volume-damping video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume_damping" /><use class="video-svg-volume-mute video-svg-symbol-hidden" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#video_volume_mute" />'},onClick:this.handleOnVolumeIconClick}),i.default.createElement("div",{className:"video-btn-volume-bar",ref:function(t){return e.volumeBar=t},onClick:this.handleOnVolumeBarClick},i.default.createElement("div",{className:"video-btn-volume-bar-level",style:{width:(a?100*s:100*n)+"%"}},i.default.createElement("button",{className:"video-btn-volume-bar-indicator",onMouseDown:this.handleOnVolumeIndicatorMouseDown,onMouseUp:this.setVolume}))))},t}(s.Component);l.displayName="IcePlayerControllerVolume",l.propTypes={volume:s.PropTypes.number.isRequired,muted:s.PropTypes.bool.isRequired,setVolume:s.PropTypes.func.isRequired,setMuted:s.PropTypes.func.isRequired},t.default=l},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=function e(t){if(o(this,e),s.call(this),this.isSupport=!0,!t.getContext)return this.isSupport=!1,void console.warn("浏览器不支持canvas");var n=t.parentNode;if(!this.canvasWidth){var r=n.clientWidth,a=n.clientHeight;this.canvasWidth=r,this.canvasHeight=a,t.width=r,t.height=a,t.style.width=r,t.style.height=a}var i=t.getContext("2d");this.fixCanvas(t),this.ctx=i,this.canvas=t,this.clearCanvas(),this.danmukuArr=[],this.col=Math.floor(t.height/30)},s=function(){var e=this;this.clearCanvas=function(){e.ctx.clearRect(0,0,e.canvasWidth,e.canvasHeight)},this.fixCanvas=function(e){var t=e.getContext("2d"),n=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,r=n/o;if(n!==o){var a=e.width,s=e.height;e.width=a*r,e.height=s*r,e.style.width=a+"px",e.style.height=s+"px",t.scale(r,r)}},this.resize=function(t){var n=t.parentNode,o=n.clientWidth,r=n.clientHeight;e.canvasWidth=o,e.canvasHeight=r,t.width=o,t.height=r,t.style.width=o,t.style.height=r,e.fixCanvas(t),e.col=Math.floor(t.height/30)},this.getFont=function(e){var t=void 0;switch(e){case"small":t="14";break;case"middle":t="20";break;case"large":t="26";break;default:t="20"}return t+"px Arial normal"},this.draw=function(){e.isSupport&&(e.timer||(e.timer=setInterval(function(){e.clearCanvas(),e.ctx.save();for(var t=e.danmukuArr,n=0,o=t.length;n<o;n+=1)if(t[n].status){var r=t[n],a=r.content,s=r.x,i=r.y;switch(e.ctx.fillStyle=t[n].fontColor,e.ctx.font=e.getFont(t[n].fontSize),e.ctx.fillText(a,s,i),t[n].insert&&(e.ctx.strokeStyle="white",e.ctx.lineCap="square",e.ctx.beginPath(),e.ctx.moveTo(s,i+3),e.ctx.lineTo(s+t[n].textWidth,i+3),e.ctx.stroke(),e.ctx.closePath()),t[n].model){case"roll":e.danmukuArr[n].x=t[n].x-t[n].speed,t[n].x<=-t[n].textWidth&&(e.danmukuArr[n].status=!1);break;case"top":case"bottom":e.danmukuArr[n].current=e.danmukuArr[n].current+30,t[n].current>=5e3&&(e.danmukuArr[n].status=!1);break;default:e.danmukuArr[n].x=t[n].x-t[n].speed,t[n].x<=-t[n].textWidth&&(e.danmukuArr[n].status=!1)}}e.ctx.restore()},30)))},this.formatData=function(t,n){var o=void 0,a=void 0,s=parseInt(Math.random()*(e.col-1)+1,10);e.ctx.font=e.getFont(t.fontSize);var i=e.ctx.measureText(t.content).width,l=i+e.canvasWidth;switch(t.model){case"roll":o=e.canvas.width,a=30*s;break;case"top":o=e.canvas.width/2-i/2,a=20*s;break;case"bottom":o=e.canvas.width/2-i/2,a=30*e.col-10*s;break;default:o=e.canvas.width,a=30*parseInt(Math.random()*(e.col-1)+1,10)}return r({},t,{x:o,y:a,textWidth:i,speed:l/165,insert:n,current:0,status:!0})},this.addDanmuku=function(t){var n=t.map(function(t){return e.formatData(t,!1)});e.danmukuArr=e.danmukuArr.concat(n)},this.insertDanmuku=function(t){var n=e.formatData(t,!0);e.danmukuArr.push(n)},this.stop=function(){clearInterval(e.timer),e.timer=null}};t.default=a},function(e,t,n){"use strict";function o(e){var t=parseInt(e,10),n=0,o=0,r=void 0;return t<60?r=t<10?"0:0"+t:"0:"+t:t<3600?(n=Math.floor(t/60),t%=60,r=t<10?n+":0"+t:n+":"+t):(o=Math.floor(t/3600),n=Math.floor((t-3600*o)/60),t%=60,n<10&&t<10?r=o+":0"+n+":0"+t:n<10&&t>=10?r=o+":0"+n+":"+t:n>=10&&t<10?r=o+":"+n+":0"+t:n>=10&&t>=10&&(r=o+":"+n+":"+t)),r}t.__esModule=!0,t.default=o},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function e(){o(this,e),this.request=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},this.exit=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},this.isFullscreen=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},this.isEnabled=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled},this.addEventListener=function(e){document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e)},this.removeEventListener=function(e){document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}};t.default=new r},function(e,n){e.exports=t},function(e,t,n){e.exports=n(1)}])});